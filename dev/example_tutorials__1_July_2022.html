<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>FUSE tutorial #1: July 7th 2022 路 FUSE</title><meta name="title" content="FUSE tutorial #1: July 7th 2022 路 FUSE"/><meta property="og:title" content="FUSE tutorial #1: July 7th 2022 路 FUSE"/><meta property="twitter:title" content="FUSE tutorial #1: July 7th 2022 路 FUSE"/><meta name="description" content="Documentation for FUSE."/><meta property="og:description" content="Documentation for FUSE."/><meta property="twitter:description" content="Documentation for FUSE."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img class="docs-light-only" src="assets/logo.svg" alt="FUSE logo"/><img class="docs-dark-only" src="assets/logo-dark.svg" alt="FUSE logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Concepts</a></li><li><a class="tocitem" href="dd.html">Data Structure</a></li><li><a class="tocitem" href="actors.html">Actors</a></li><li><span class="tocitem">Parameters</span><ul><li><a class="tocitem" href="ini.html">ini Parameters</a></li><li><a class="tocitem" href="act.html">act Parameters</a></li><li><a class="tocitem" href="cases.html">Use Cases</a></li><li><a class="tocitem" href="inits.html">Initialization</a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="develop.html">Development</a></li><li><span class="tocitem">Install</span><ul><li><a class="tocitem" href="install.html">Install FUSE</a></li><li><a class="tocitem" href="install_saga.html">on SAGA</a></li><li><a class="tocitem" href="install_omega.html">on OMEGA</a></li></ul></li><li><span class="tocitem">License</span><ul><li><a class="tocitem" href="license.html">License</a></li><li><a class="tocitem" href="notice.html">Notice</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="example_tutorials__1_July_2022.html">FUSE tutorial #1: July 7th 2022</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="example_tutorials__1_July_2022.html">FUSE tutorial #1: July 7th 2022</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="FUSE-tutorial-#1:-July-7th-2022"><a class="docs-heading-anchor" href="#FUSE-tutorial-#1:-July-7th-2022">FUSE tutorial #1: July 7th 2022</a><a id="FUSE-tutorial-#1:-July-7th-2022-1"></a><a class="docs-heading-anchor-permalink" href="#FUSE-tutorial-#1:-July-7th-2022" title="Permalink"></a></h1><p><strong>NOTE:</strong> Always referr to the <a href="https://fuse.help/index.html">FUSE documentation</a> for most up-to-date information</p><hr/><h2 id="Watch-the-[video-recording-of-this-tutorial](https://github.com/ProjectTorreyPines/FUSE_extra_files/raw/master/FUSE_tutorial_1_6Jul22.mp4)"><a class="docs-heading-anchor" href="#Watch-the-[video-recording-of-this-tutorial](https://github.com/ProjectTorreyPines/FUSE_extra_files/raw/master/FUSE_tutorial_1_6Jul22.mp4)">Watch the <a href="https://github.com/ProjectTorreyPines/FUSE_extra_files/raw/master/FUSE_tutorial_1_6Jul22.mp4">video recording of this tutorial</a></a><a id="Watch-the-[video-recording-of-this-tutorial](https://github.com/ProjectTorreyPines/FUSE_extra_files/raw/master/FUSE_tutorial_1_6Jul22.mp4)-1"></a><a class="docs-heading-anchor-permalink" href="#Watch-the-[video-recording-of-this-tutorial](https://github.com/ProjectTorreyPines/FUSE_extra_files/raw/master/FUSE_tutorial_1_6Jul22.mp4)" title="Permalink"></a></h2><hr/><p>FUSE (<strong>FU</strong>sion <strong>S</strong>ynthesis <strong>E</strong>ngine) is GA&#39;s proprietary framework for Fusion Power Plant (FPP) integrated design.</p><h2 id="FUSE-objectives"><a class="docs-heading-anchor" href="#FUSE-objectives">FUSE objectives</a><a id="FUSE-objectives-1"></a><a class="docs-heading-anchor-permalink" href="#FUSE-objectives" title="Permalink"></a></h2><ul><li>Couple physics, engineering, control, costing, and balance of plant</li><li>Enable both stationary as well as time-dependent simulations</li><li>Be generic and modular, supporting hierarcy of models</li><li>Leverage parallelism and HPC systems for optimization studies</li><li>Support sensitivity and uncertainty quantification analyses</li></ul><h2 id="Basic-concepts"><a class="docs-heading-anchor" href="#Basic-concepts">Basic concepts</a><a id="Basic-concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-concepts" title="Permalink"></a></h2><p>FUSE is written completely in Julia, and is structured as follows:</p><ol><li>Data is stored in the <code>dd</code> data structure, which is based on the ITER IMAS onthology</li><li>Physics and engineering <code>actors</code> are the fundamental building blocks of FUSE simulations</li><li>Actors functionality is controlled via <code>act</code> parameters</li><li>The data structure can be initialized starting from 0D <code>ini</code> parameters</li><li>FUSE comes with a series of template <code>use cases</code> for different machines (FPP, ITER, ARC, ...)</li><li><code>workflows</code> perform self-contained studies/optimizations (typically running many FUSE simulations)</li><li>FUSE can interface with the existing GA ecosystem of modeling codes (GASC, OMFIT/OMAS) as well as IMAS</li></ol><p>These concepts are illustrated in the diagram below:</p><p><img src="../../docs/src/assets/FUSE.svg" alt="svg"/></p><h2 id="Tutorial-outline"><a class="docs-heading-anchor" href="#Tutorial-outline">Tutorial outline</a><a id="Tutorial-outline-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-outline" title="Permalink"></a></h2><ul><li>The objectives and concepts of FUSE</li><li>How to set-up a case (Fusion Power Plant v1_demount)</li><li>How to interact with FUSE objects (dd, ini, act)</li><li>How to run Actors and modify them</li><li>Optimization</li></ul><h4 id="NOTE:"><a class="docs-heading-anchor" href="#NOTE:">NOTE:</a><a id="NOTE:-1"></a><a class="docs-heading-anchor-permalink" href="#NOTE:" title="Permalink"></a></h4><ul><li>This is not a <a href="https://www.youtube.com/watch?v=FntEfT8R2fY">Julia tutorial</a></li><li>This is not a <a href="https://jupyterlab.readthedocs.io/en/latest/user/notebook.html">Jupyter Lab tutorial</a></li></ul><h2 id="A-simple-example"><a class="docs-heading-anchor" href="#A-simple-example">A simple example</a><a id="A-simple-example-1"></a><a class="docs-heading-anchor-permalink" href="#A-simple-example" title="Permalink"></a></h2><pre><code class="language- hljs">@time begin # Julia is Just In Time compiled (JIT), which means the first execution takes a while (it needs to compile!), then it will be fast
    
    # Revise package for development (always import this first, will talk about this at the end)
    using Revise

    # FUSE package and logger
    using FUSE
    FUSE.logging(Logging.Info)

    # Get `ini` and `act` for a given use-case
    ini, act = FUSE.case_parameters(:FPP; version=:v1_demount, init_from=:scalars)

    # Initialize `dd` from 0D parameters
    dd = FUSE.init(ini, act; do_plot=false)

    # Run an actor
    FUSE.ActorEquilibriumTransport(dd, act; do_plot=true);

end;</code></pre><h2 id="Handling-FUSE-data:-dd,-ini,-act"><a class="docs-heading-anchor" href="#Handling-FUSE-data:-dd,-ini,-act">Handling FUSE data: <code>dd</code>, <code>ini</code>, <code>act</code></a><a id="Handling-FUSE-data:-dd,-ini,-act-1"></a><a class="docs-heading-anchor-permalink" href="#Handling-FUSE-data:-dd,-ini,-act" title="Permalink"></a></h2><h3 id="1.-Playing-around-with-dd"><a class="docs-heading-anchor" href="#1.-Playing-around-with-dd">1. Playing around with <code>dd</code></a><a id="1.-Playing-around-with-dd-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Playing-around-with-dd" title="Permalink"></a></h3><ul><li>FUSE stores data according to the IMAS data schema</li><li>The root of the data structure where FUSE stores data is generally referred to as <code>dd</code> (which stands for <code>Data Dictionary</code>)</li><li>See the <a href="https://fuse.help/dd.html"><code>IMAS.dd()</code> documentation</a></li></ul><h4 id="Show-dd-content"><a class="docs-heading-anchor" href="#Show-dd-content">Show <code>dd</code> content</a><a id="Show-dd-content-1"></a><a class="docs-heading-anchor-permalink" href="#Show-dd-content" title="Permalink"></a></h4><pre><code class="language- hljs">dd; # remove `;` to see the whole data structure</code></pre><pre><code class="language- hljs"># We take a look at only one portion of dd
dd.equilibrium.time_slice[2].boundary</code></pre><h4 id="Show-IMAS-stucture"><a class="docs-heading-anchor" href="#Show-IMAS-stucture">Show IMAS stucture</a><a id="Show-IMAS-stucture-1"></a><a class="docs-heading-anchor-permalink" href="#Show-IMAS-stucture" title="Permalink"></a></h4><ul><li><code>dd</code>, <code>dd.equilibrium</code>, ... are instances of Julia <code>strut</code>s that are defined in the <code>IMASdd.jl</code> package<ul><li><code>dd = IMAS.dd()</code></li><li><code>dd.equilibrium</code> is of type <code>IMAS.equilibrium</code></li><li><code>dd.equilibrium.time_slice</code> is of type <code>IMAS.equilibrium__time_slice</code></li><li><code>dd.equilibrium.time_slice[1].boundary</code> is of type <code>IMAS.equilibrium__time_slice___boundary</code></li></ul></li><li>The curious reader can take a look at the <a href="../../../IMASdd/src/dd.jl">IMASdd/src/dd.jl</a> file to see those definitions</li></ul><pre><code class="language- hljs"># whenever things start with `IMAS.`, then this is a Julia type
IMAS.equilibrium</code></pre><pre><code class="language- hljs"># which is different from the instance filled with data
dd.equilibrium</code></pre><h4 id="Plot-data-in-dd"><a class="docs-heading-anchor" href="#Plot-data-in-dd">Plot data in <code>dd</code></a><a id="Plot-data-in-dd-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-data-in-dd" title="Permalink"></a></h4><ul><li>There are <a href="https://docs.juliaplots.org/latest/recipes/">Plots.jl recipies</a> defined for different IMASdd.jl types of structs</li><li>These recipies are defined in <a href="../../../IMAS/src/plot.jl">IMAS/src/plot.jl</a></li><li>Plots can be <a href="https://docs.juliaplots.org/latest/generated/attributes_series">customized</a></li><li>NOTE: use <code>display()</code> is used to force the plot to show when <code>plot</code> is not called at the end of the cell</li></ul><pre><code class="language- hljs">using Plots
plot(dd.equilibrium)</code></pre><pre><code class="language- hljs">plot(dd.core_profiles)</code></pre><pre><code class="language- hljs">plot(dd.core_sources)</code></pre><pre><code class="language- hljs"># plots can be composed
plot(dd.equilibrium, color=:gray)
plot!(dd.build)
plot!(dd.build, cx=false)</code></pre><pre><code class="language- hljs"># plot of an array ...
plot(dd.core_profiles.profiles_1d[1].pressure_thermal)</code></pre><pre><code class="language- hljs"># ... is different than plotting of a field in an IDS
plot(dd.core_profiles.profiles_1d[1], :pressure_thermal)</code></pre><pre><code class="language- hljs"># plots can be customized: https://docs.juliaplots.org/latest/generated/attributes_series
plot(dd.core_profiles.profiles_1d[1], :pressure_thermal, label=&quot;&quot;, linewidth=2, color=:red, labelfontsize=25)</code></pre><h4 id="Working-with-time-series"><a class="docs-heading-anchor" href="#Working-with-time-series">Working with time series</a><a id="Working-with-time-series-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-time-series" title="Permalink"></a></h4><ul><li>The IMAS data structure can accomodate time-dependent data</li><li>Manually handling time in IMAS is tedius and error-prone</li><li>IMAS.jl provides convenient ways to handle time<ul><li><code>dd.global_time</code>庐 sets the &quot;current working time&quot; throughout all of the <code>dd</code></li><li>different IDSs can have time arrays of different lengths</li><li>data returned based on nearest neighbour</li></ul></li></ul><pre><code class="language- hljs">@show dd.global_time
@show dd.equilibrium.time;</code></pre><pre><code class="language- hljs"># To access a time-dependent array of structures at time slice use **Integer** index
eqt = dd.equilibrium.time_slice[2]
@show eqt.time;</code></pre><pre><code class="language- hljs"># To access a time-dependent array of structures at `dd.globaltime` use []
eqt = dd.equilibrium.time_slice[]
@show eqt.time;</code></pre><pre><code class="language- hljs"># To access a time-dependent array of structures at a given time use **Float** time
eqt = dd.equilibrium.time_slice[0.0]
@show eqt.time;</code></pre><pre><code class="language- hljs"># To access a time-dependent array we use @ddtime macro
@show dd.equilibrium.vacuum_toroidal_field.b0; # this is a time dependent data array</code></pre><pre><code class="language- hljs"># GET data of time-dependent array at `dd.globaltime` (use `IMAS.get_time_array()` to access at other times)
my_b0 = @ddtime(dd.equilibrium.vacuum_toroidal_field.b0)</code></pre><pre><code class="language- hljs"># SET data of time-dependent array at `dd.globaltime` (use `IMAS.set_time_array()` to access at other times)
my_b0 = round(my_b0; digits=3)
@ddtime(dd.equilibrium.vacuum_toroidal_field.b0 = my_b0)</code></pre><h4 id="Expressions"><a class="docs-heading-anchor" href="#Expressions">Expressions</a><a id="Expressions-1"></a><a class="docs-heading-anchor-permalink" href="#Expressions" title="Permalink"></a></h4><ul><li><p>Many fields in the IMAS data structure are related to one another. Given some fields others can be calculated. This leads to an issue of consistency, where if some field is updated, all the fields that relies on that data should be updated too.</p></li><li><p>IMAS.jl solves this problem by assigning expressions to certain fields. The value of these expressions are then evaluated on the fly, when the field is requested.</p></li><li><p>Expressions are defined in <a href="../../../IMAS/src/expressions.jl">IMAS/src/expressions.jl</a></p></li></ul><pre><code class="language- hljs">dd.core_profiles.profiles_1d[1].electrons</code></pre><pre><code class="language- hljs"># accessing the field evaluates the expression
dd.core_profiles.profiles_1d[1].electrons.pressure</code></pre><pre><code class="language- hljs"># IMAS.freeze evaluates all expressions
e1d = IMAS.freeze(dd.core_profiles.profiles_1d[1].electrons)</code></pre><h4 id="Saving/loading-data"><a class="docs-heading-anchor" href="#Saving/loading-data">Saving/loading data</a><a id="Saving/loading-data-1"></a><a class="docs-heading-anchor-permalink" href="#Saving/loading-data" title="Permalink"></a></h4><ul><li>IMAS.jl can dump data in JSON format, to pass data to other codes (OMFIT/OMAS, ...)</li></ul><pre><code class="language- hljs">using Printf

# Dump data to JSON
tutorial_dir = tempdir()
save_name = &quot;FPP_v1_starting_point.json&quot;
filename=joinpath(tutorial_dir, save_name)
@time IMAS.imas2json(dd, filename);
@show filename
@printf(&quot;%2.2f MB\n&quot;,filesize(filename)/1024/1024)</code></pre><ul><li>IMAS.jl can save/load data in JLD2 (JuLia Data format v2), which allows it to store/reload <code>dd</code> with all richness (expressions, <code>Inf</code>, <code>NaN</code>, complex, ...) that is not possible to capture with JSON format.</li></ul><pre><code class="language- hljs"># Save and reload from JLD2
save_name = &quot;FPP_v1_starting_point.jld2&quot;
filename = joinpath(tutorial_dir, save_name)
@time IMAS.save(dd, filename)
@time dd1 = IMAS.load(filename)
@show filename
@printf(&quot;%2.2f MB\n&quot;, filesize(filename)/1024/1024)</code></pre><pre><code class="language- hljs"># Check for differences
dd1.equilibrium.time_slice[1].time = -100.0
IMAS.diff(dd, dd1);</code></pre><h3 id="2.-Playing-around-with-ini"><a class="docs-heading-anchor" href="#2.-Playing-around-with-ini">2. Playing around with <code>ini</code></a><a id="2.-Playing-around-with-ini-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Playing-around-with-ini" title="Permalink"></a></h3><ul><li>See the <a href="https://fuse.help/ini.html"><code>ParametersInit()</code> documentation</a></li><li>Organized by topical areas</li><li>Can have multiple layers of nesting</li><li>Most field defaulted to <code>missing</code></li></ul><pre><code class="language- hljs">new_ini = FUSE.ParametersAllInits()</code></pre><pre><code class="language- hljs"># access a sub-tree
new_ini.equilibrium</code></pre><pre><code class="language- hljs"># access a leaf
new_ini.equilibrium.Z0</code></pre><h4 id="Access-detailed-descriptions-[online](https://fuse.help/ini_details.html#ini.equilibrium.Z0)"><a class="docs-heading-anchor" href="#Access-detailed-descriptions-[online](https://fuse.help/ini_details.html#ini.equilibrium.Z0)">Access detailed descriptions <a href="https://fuse.help/ini_details.html#ini.equilibrium.Z0">online</a></a><a id="Access-detailed-descriptions-[online](https://fuse.help/ini_details.html#ini.equilibrium.Z0)-1"></a><a class="docs-heading-anchor-permalink" href="#Access-detailed-descriptions-[online](https://fuse.help/ini_details.html#ini.equilibrium.Z0)" title="Permalink"></a></h4><ul><li>Notice <strong>units</strong>, <strong>descriptons</strong></li><li>Some fields only allow a limited set of <strong>options</strong></li><li>Each field stores three things:<ul><li><strong>default</strong>: default value when <code>ini = ParametersInit()</code> is first called</li><li><strong>base</strong>: value when <code>FUSE.set_new_base!(ini)</code> is called</li><li><strong>value</strong>: current value</li></ul></li></ul><pre><code class="language- hljs"># Error if trying to access something not initialized
try
    new_ini.equilibrium.ip
catch e
    Base.showerror(stderr, e)
end</code></pre><pre><code class="language- hljs"># Some ini fields only allow a limited set of options
try
    new_ini.tf.technology.material = &quot;something&quot;
catch e
    Base.showerror(stderr, e)
end</code></pre><pre><code class="language- hljs"># Making changes highlight things in *red* 
new_ini.equilibrium.B0 = 6.12
new_ini.equilibrium.R0 = 5.1
new_ini.equilibrium</code></pre><pre><code class="language- hljs"># setting a new `base`  (this is done at the end of use-cases definitions), highlights entries in *blue*
FUSE.set_new_base!(new_ini)
new_ini.equilibrium</code></pre><pre><code class="language- hljs"># Making changes highlight things in *red* 
new_ini.equilibrium.B0 = 6.123
new_ini.equilibrium</code></pre><h4 id="Usecases-return-pre-filled-ini-and-act-parameters"><a class="docs-heading-anchor" href="#Usecases-return-pre-filled-ini-and-act-parameters">Usecases return pre-filled <code>ini</code> and <code>act</code> parameters</a><a id="Usecases-return-pre-filled-ini-and-act-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Usecases-return-pre-filled-ini-and-act-parameters" title="Permalink"></a></h4><p>See for example:</p><ul><li><a href="../../../FUSE/cases/FPP.jl">FUSE/cases/FPP.jl</a></li><li><a href="../../../FUSE/cases/ITER.jl">FUSE/cases/ITER.jl</a></li><li><a href="../../../FUSE/cases/ARC.jl">FUSE/cases/ARC.jl</a></li></ul><pre><code class="language- hljs">ini, act = FUSE.case_parameters(:FPP; version=:v1_demount, init_from=:scalars)
ini.equilibrium</code></pre><h3 id="3.-Playing-around-with-act"><a class="docs-heading-anchor" href="#3.-Playing-around-with-act">3. Playing around with <code>act</code></a><a id="3.-Playing-around-with-act-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Playing-around-with-act" title="Permalink"></a></h3><ul><li><a href="https://fuse.help/act.html"><code>FUSE.ParametersActor()</code> documentation</a></li></ul><h4 id="Show-overall-organization"><a class="docs-heading-anchor" href="#Show-overall-organization">Show overall organization</a><a id="Show-overall-organization-1"></a><a class="docs-heading-anchor-permalink" href="#Show-overall-organization" title="Permalink"></a></h4><ul><li>Organized by Actor</li><li>Works the same was as <code>ini</code> Parameters</li></ul><pre><code class="language- hljs">act</code></pre><h2 id="Running-actors"><a class="docs-heading-anchor" href="#Running-actors">Running actors</a><a id="Running-actors-1"></a><a class="docs-heading-anchor-permalink" href="#Running-actors" title="Permalink"></a></h2><ul><li><a href="https://fuse.help/actors.html">Actors documentation</a></li><li>We&#39;ll manually step through wht <strong>ActorWholeFacility</strong> does:<ul><li><strong>ActorHFSsizing</strong>: Sizes the High Field Side of radial build (plug, OH, TF) superconductors and stresses</li><li><strong>ActorLFSsizing</strong>: Sizes the Low Field Side of radial build</li><li><strong>ActorCXbuild</strong>: Generate the 2D cross section of the build</li><li><strong>ActorPFcoilsOpt</strong>: Find optimal PF coil locations and currents to match equilibrium boundary shape and a field-null region</li><li><strong>ActorNeutronics</strong>: Calculate neutron loading on the wall</li><li><strong>ActorBlanket</strong>: Blanket tritium breeding ration and heating</li><li><strong>ActorDivertors</strong>: Divertor heat flux</li><li><strong>ActorBalanceOfPlant</strong>: Calculate the net electrical power output</li><li><strong>ActorCosting</strong>: Calculate the cost of the fusion power plant</li></ul></li></ul><pre><code class="language- hljs"># Start from scratch
ini, act = FUSE.case_parameters(:FPP; version=:v1_demount, init_from=:scalars)
ini.pf_active.n_pf_coils_outside = 6;
ini.core_profiles.zeff = 2.0
dd = FUSE.init(ini, act; do_plot=false);</code></pre><pre><code class="language- hljs">@time FUSE.ActorEquilibriumTransport(dd, act;do_plot=true);</code></pre><pre><code class="language- hljs">@time FUSE.ActorHFSsizing(dd, act; do_plot=true);
display(plot(dd.solid_mechanics.center_stack.stress))
dd.build.oh</code></pre><pre><code class="language- hljs">@time FUSE.ActorLFSsizing(dd, act; do_plot=true);
display(dd.build.tf)</code></pre><pre><code class="language- hljs">@time FUSE.ActorCXbuild(dd, act; do_plot=true);</code></pre><pre><code class="language- hljs"># weight_currents: make smaller to force currents to fit in the limits
# update_equilibrium: overwrite the target equilibrium with what the coils can actually generate
@time FUSE.ActorPFcoilsOpt(dd, act; weight_currents=.4, do_plot=true, update_equilibrium=true);</code></pre><pre><code class="language- hljs"># Let&#39;s run the ActorCXbuild to update the first wall shape based on the new equilibrium
@time FUSE.ActorCXbuild(dd, act,rebuild_wall=true; do_plot=false);
plot(dd.equilibrium; cx=true)
plot!(dd.build; legend=false)</code></pre><pre><code class="language- hljs">@time FUSE.ActorNeutronics(dd, act; do_plot=true);</code></pre><pre><code class="language- hljs">@time FUSE.ActorBlanket(dd, act)#; do_plot=true);
dd.blanket</code></pre><pre><code class="language- hljs">@time FUSE.ActorDivertors(dd, act)#; do_plot=true);
dd.divertors</code></pre><pre><code class="language- hljs">@time FUSE.ActorBalanceOfPlant(dd,act)#; do_plot=true);
IMAS.freeze(dd.balance_of_plant)</code></pre><pre><code class="language- hljs">@time FUSE.ActorCosting(dd, act)#; do_plot=true);
IMAS.freeze(dd.costing)</code></pre><pre><code class="language- hljs"># Save `dd` to Json, so we can share our results with others
IMAS.imas2json(dd,&quot;fpp_v1_FUSE.json&quot;)

# NOTE: can be loaded in OMFIT this way
# OMFIT[&quot;FUSE&quot;] = ODS().load(&quot;.../fpp_v1_FUSE.json&quot;, consistency_check=False)</code></pre><h2 id="Worfklows-(ie.-studies)"><a class="docs-heading-anchor" href="#Worfklows-(ie.-studies)">Worfklows (ie. studies)</a><a id="Worfklows-(ie.-studies)-1"></a><a class="docs-heading-anchor-permalink" href="#Worfklows-(ie.-studies)" title="Permalink"></a></h2><p>Perform self-contained studies/optimizations (typically running many FUSE simulations)</p><ul><li><p><a href="https://fuse.help/example_workflows__transport_equilibrium_validation.html">HDB5 validation of ActorEquilibriumTransport</a></p><p><a href="workflow_hdb5.png">&lt;img src=&quot;../../docs/src/assets/workflow_hdb5.png&quot; width=&quot;600&quot;/&gt;</a></p></li><li><p><a href="https://fuse.help/example_workflows__multi_objective_optimization.html">Multi objective optimization</a></p><p><a href="workflow_moopt.png">&lt;img src=&quot;../../docs/src/assets/workflow_moopt.png&quot; width=&quot;600&quot;/&gt;</a></p></li></ul><h2 id="Install-Julia-and-FUSE"><a class="docs-heading-anchor" href="#Install-Julia-and-FUSE">Install Julia and FUSE</a><a id="Install-Julia-and-FUSE-1"></a><a class="docs-heading-anchor-permalink" href="#Install-Julia-and-FUSE" title="Permalink"></a></h2><ul><li>Julia comes with its own <a href="https://blog.devgenius.io/the-most-underrated-feature-of-the-julia-programming-language-the-package-manager-652065f45a3a">package manager</a></li><li>Refer to online documentation https://fuse.help/install.html<ul><li>How to install Julia/FUSE</li><li>How to update FUSE</li></ul></li></ul><h2 id="Development"><a class="docs-heading-anchor" href="#Development">Development</a><a id="Development-1"></a><a class="docs-heading-anchor-permalink" href="#Development" title="Permalink"></a></h2><ul><li>Refer to online documentation https://fuse.help/develop.html</li><li>Use of <code>Revise</code></li><li>Illustrate example development workflow using VScode</li><li>Commit</li><li>Tracking <a href="https://github.com/orgs/ProjectTorreyPines/projects/2/views/1">issues actross different repositories</a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 19 August 2024 19:40">Monday 19 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
