<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Current evolution · FUSE</title><meta name="title" content="Current evolution · FUSE"/><meta property="og:title" content="Current evolution · FUSE"/><meta property="twitter:title" content="Current evolution · FUSE"/><meta name="description" content="Documentation for FUSE."/><meta property="og:description" content="Documentation for FUSE."/><meta property="twitter:description" content="Documentation for FUSE."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img class="docs-light-only" src="assets/logo.svg" alt="FUSE logo"/><img class="docs-dark-only" src="assets/logo-dark.svg" alt="FUSE logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Concepts</a></li><li><a class="tocitem" href="dd.html">Data Structure</a></li><li><a class="tocitem" href="actors.html">Actors</a></li><li><span class="tocitem">Parameters</span><ul><li><a class="tocitem" href="ini.html">ini Parameters</a></li><li><a class="tocitem" href="act.html">act Parameters</a></li><li><a class="tocitem" href="cases.html">Use Cases</a></li><li><a class="tocitem" href="inits.html">Initialization</a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="develop.html">Development</a></li><li><span class="tocitem">Install</span><ul><li><a class="tocitem" href="install.html">Install FUSE</a></li><li><a class="tocitem" href="install_saga.html">on SAGA</a></li><li><a class="tocitem" href="install_omega.html">on OMEGA</a></li></ul></li><li><span class="tocitem">License</span><ul><li><a class="tocitem" href="license.html">License</a></li><li><a class="tocitem" href="notice.html">Notice</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="example_actors__Current.html">Current evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="example_actors__Current.html">Current evolution</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Current-evolution"><a class="docs-heading-anchor" href="#Current-evolution">Current evolution</a><a id="Current-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Current-evolution" title="Permalink"></a></h1><pre><code class="language- hljs">using Revise
using FUSE
using Plots;
FUSE.logging(Logging.Info; actors=Logging.Debug);</code></pre><pre><code class="language- hljs"># Load TRANSP data at 2.91 s
import QED
file_0 = joinpath(dirname(pathof(QED)), &quot;..&quot;,&quot;sample&quot;, &quot;ods_163303Z29-2910.json&quot;)
dd = IMAS.json2imas(file_0; verbose=false)

act=FUSE.ParametersActors()

# initialize actor
actor = FUSE.ActorQED(dd, act)

# evolve current
#for k in 1:3
#    FUSE.step(actor, 0.1, 100, resume=true)
#    FUSE.finalize(actor)
#    dd.global_time = dd.equilibrium.time[end]
#end</code></pre><pre class="nohighlight"><code class="nohighlight hljs">[ Info: QED



MethodError: no method matching _step(::FUSE.ActorQED{Float64, Float64})

Closest candidates are:
  _step(::FUSE.ActorQED, ::Any, ::Any)
   @ FUSE ~/.julia/dev/FUSE/src/actors/current/qed_actor.jl:46
  _step(::FUSE.ActorQED, ::Any, ::Any, ::Any)
   @ FUSE ~/.julia/dev/FUSE/src/actors/current/qed_actor.jl:46
  _step(::FUSE.ActorQED, ::Any, ::Any, ::Any, ::Any; resume)
   @ FUSE ~/.julia/dev/FUSE/src/actors/current/qed_actor.jl:46
  ...




Stacktrace:

 [1] macro expansion

   @ ~/.julia/dev/FUSE/src/actors/abstract_actors.jl:41 [inlined]

 [2] macro expansion

   @ ~/.julia/packages/TimerOutputs/RsWnF/src/TimerOutput.jl:237 [inlined]

 [3] step(::FUSE.ActorQED{Float64, Float64}; kw::Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})

   @ FUSE ~/.julia/dev/FUSE/src/actors/abstract_actors.jl:38

 [4] step(::FUSE.ActorQED{Float64, Float64})

   @ FUSE ~/.julia/dev/FUSE/src/actors/abstract_actors.jl:33

 [5] FUSE.ActorQED(dd::IMASdd.dd{Float64}, act::FUSE.ParametersActors{Float64}; kw::Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})

   @ FUSE ~/.julia/dev/FUSE/src/actors/current/qed_actor.jl:31

 [6] FUSE.ActorQED(dd::IMASdd.dd{Float64}, act::FUSE.ParametersActors{Float64})

   @ FUSE ~/.julia/dev/FUSE/src/actors/current/qed_actor.jl:29

 [7] top-level scope

   @ In[27]:9</code></pre><pre><code class="language- hljs">dd</code></pre><pre class="nohighlight"><code class="nohighlight hljs">dd
├─ balance_of_plant
│  ├─ Q_plant ➡ Function
│  ├─ power_electric_net ➡ Function [W]
│  ├─ power_electric_plant_operation
│  │  └─ total_power ➡ Function [W]
│  └─ thermal_cycle
│     ├─ power_electric_generated ➡ Function [W]
│     └─ total_useful_heat_power ➡ Function [W]
├─ build
│  └─ tf
│     ├─ ripple ➡ Function
│     └─ wedge_thickness ➡ Function [m]
├─ core_profiles
│  ├─ profiles_1d
│  │  └─ 1
│  │     ├─ conductivity_parallel ➡ 101-element Vector{Float64} [ohm^-1.m^-1]
│  │     ├─ electrons
│  │     │  ├─ density ➡ Function [m^-3]
│  │     │  ├─ density_fast ➡ Function [m^-3]
│  │     │  ├─ pressure ➡ Function [Pa]
│  │     │  ├─ pressure_fast_parallel ➡ Function [Pa]
│  │     │  ├─ pressure_fast_perpendicular ➡ Function [Pa]
│  │     │  └─ pressure_thermal ➡ Function [Pa]
│  │     ├─ grid
│  │     │  ├─ area ➡ Function [m^2]
│  │     │  ├─ psi ➡ Function [Wb]
│  │     │  ├─ psi_norm ➡ Function
│  │     │  ├─ rho_tor_norm ➡ 101-element Vector{Float64}
│  │     │  ├─ surface ➡ Function [m^2]
│  │     │  └─ volume ➡ Function [m^3]
│  │     ├─ j_bootstrap ➡ Function [A/m^2]
│  │     ├─ j_non_inductive ➡ 101-element Vector{Float64} [A/m^2]
│  │     ├─ j_ohmic ➡ Function [A/m^2]
│  │     ├─ j_tor ➡ Function [A/m^2]
│  │     ├─ j_total ➡ Function [A/m^2]
│  │     ├─ pressure ➡ Function [Pa]
│  │     ├─ pressure_ion_total ➡ Function [Pa]
│  │     ├─ pressure_parallel ➡ Function [Pa]
│  │     ├─ pressure_perpendicular ➡ Function [Pa]
│  │     ├─ pressure_thermal ➡ Function [Pa]
│  │     ├─ t_i_average ➡ Function [eV]
│  │     └─ time ➡ Function [s]
│  ├─ time ➡ [2.91] [s]
│  └─ vacuum_toroidal_field
│     ├─ b0 ➡ Function [T]
│     └─ r0 ➡ Function [m]
├─ core_sources
│  └─ vacuum_toroidal_field
│     ├─ b0 ➡ Function [T]
│     └─ r0 ➡ Function [m]
├─ costing
│  ├─ cost_decommissioning
│  │  └─ cost ➡ Function [$M]
│  ├─ cost_direct_capital
│  │  └─ cost ➡ Function [$M]
│  └─ cost_operations
│     └─ yearly_cost ➡ Function [$M/year]
├─ equilibrium
│  ├─ time ➡ [2.91] [s]
│  ├─ time_slice
│  │  └─ 1
│  │     ├─ boundary
│  │     │  ├─ elongation ➡ Function
│  │     │  ├─ elongation_lower ➡ Function
│  │     │  ├─ elongation_upper ➡ Function
│  │     │  ├─ geometric_axis
│  │     │  │  ├─ r ➡ Function [m]
│  │     │  │  └─ z ➡ Function [m]
│  │     │  ├─ minor_radius ➡ Function [m]
│  │     │  ├─ squareness ➡ Function
│  │     │  ├─ squareness_lower_inner ➡ Function
│  │     │  ├─ squareness_lower_outer ➡ Function
│  │     │  ├─ squareness_upper_inner ➡ Function
│  │     │  ├─ squareness_upper_outer ➡ Function
│  │     │  ├─ triangularity ➡ Function
│  │     │  ├─ triangularity_lower ➡ Function
│  │     │  └─ triangularity_upper ➡ Function
│  │     ├─ global_quantities
│  │     │  ├─ energy_mhd ➡ Function [J]
│  │     │  ├─ ip ➡ 1.24079e+06 [A]
│  │     │  ├─ magnetic_axis
│  │     │  │  ├─ b_field_tor ➡ Function [T]
│  │     │  │  ├─ r ➡ Function [m]
│  │     │  │  └─ z ➡ Function [m]
│  │     │  ├─ psi_axis ➡ Function [Wb]
│  │     │  ├─ psi_boundary ➡ Function [Wb]
│  │     │  ├─ q_95 ➡ Function
│  │     │  └─ q_axis ➡ Function
│  │     ├─ profiles_1d
│  │     │  ├─ dpressure_dpsi ➡ Function [Pa.Wb^-1]
│  │     │  ├─ dvolume_drho_tor ➡ 101-element Vector{Float64} [m^2]
│  │     │  ├─ f ➡ 101-element Vector{Float64} [T.m]
│  │     │  ├─ geometric_axis
│  │     │  │  ├─ r ➡ Function [m]
│  │     │  │  └─ z ➡ Function [m]
│  │     │  ├─ gm1 ➡ 101-element Vector{Float64} [m^-2]
│  │     │  ├─ gm2 ➡ 101-element Vector{Float64} [m^-2]
│  │     │  ├─ gm9 ➡ 101-element Vector{Float64} [m^-1]
│  │     │  ├─ j_parallel ➡ Function [A/m^2]
│  │     │  ├─ j_tor ➡ 101-element Vector{Float64} [A.m^-2]
│  │     │  ├─ psi ➡ 101-element Vector{Float64} [Wb]
│  │     │  ├─ psi_norm ➡ Function
│  │     │  ├─ q ➡ 101-element Vector{Float64}
│  │     │  ├─ rho_tor ➡ 101-element Vector{Float64} [m]
│  │     │  └─ rho_tor_norm ➡ 101-element Vector{Float64}
│  │     └─ time ➡ Function [s]
│  └─ vacuum_toroidal_field
│     └─ b0 ➡ [-2.08192] [T]
├─ stability
│  └─ all_cleared ➡ Function
└─ summary
   ├─ fusion
   │  └─ power
   │     └─ value ➡ Function [W]
   ├─ global_quantities
   │  ├─ b0
   │  │  └─ value ➡ Function [T]
   │  ├─ beta_pol_mhd
   │  │  └─ value ➡ Function
   │  ├─ beta_tor
   │  │  └─ value ➡ Function
   │  ├─ beta_tor_mhd
   │  │  └─ value ➡ Function
   │  ├─ beta_tor_norm
   │  │  └─ value ➡ Function
   │  ├─ beta_tor_norm_mhd
   │  │  └─ value ➡ Function
   │  ├─ beta_tor_thermal_norm
   │  │  └─ value ➡ Function
   │  ├─ current_bootstrap
   │  │  └─ value ➡ Function [A]
   │  ├─ current_non_inductive
   │  │  └─ value ➡ Function [A]
   │  ├─ current_ohm
   │  │  └─ value ➡ Function [A]
   │  ├─ energy_thermal
   │  │  └─ value ➡ Function [J]
   │  ├─ h_98
   │  │  └─ value ➡ Function
   │  ├─ ip
   │  │  └─ value ➡ Function [A]
   │  ├─ r0
   │  │  └─ value ➡ Function [m]
   │  ├─ tau_energy
   │  │  └─ value ➡ Function [s]
   │  └─ tau_energy_98
   │     └─ value ➡ Function [s]
   ├─ heating_current_drive
   │  ├─ power_launched_ec
   │  │  └─ value ➡ Function [W]
   │  ├─ power_launched_ic
   │  │  └─ value ➡ Function [W]
   │  ├─ power_launched_lh
   │  │  └─ value ➡ Function [W]
   │  ├─ power_launched_nbi
   │  │  └─ value ➡ Function [W]
   │  └─ power_launched_total
   │     └─ value ➡ Function [W]
   ├─ local
   │  ├─ magnetic_axis
   │  │  ├─ n_e
   │  │  │  └─ value ➡ Function [m^-3]
   │  │  ├─ t_e
   │  │  │  └─ value ➡ Function [eV]
   │  │  ├─ t_i_average
   │  │  │  └─ value ➡ Function [eV]
   │  │  └─ zeff
   │  │     └─ value ➡ Function
   │  └─ separatrix
   │     ├─ n_e
   │     │  └─ value ➡ Function [m^-3]
   │     ├─ t_e
   │     │  └─ value ➡ Function [eV]
   │     ├─ t_i_average
   │     │  └─ value ➡ Function [eV]
   │     └─ zeff
   │        └─ value ➡ Function
   └─ volume_average
      ├─ n_e
      │  └─ value ➡ Function [m^-3]
      ├─ t_e
      │  └─ value ➡ Function [eV]
      ├─ t_i_average
      │  └─ value ➡ Function [eV]
      └─ zeff
         └─ value ➡ Function</code></pre><h3 id="Initialize-FPP-v1_demount-case"><a class="docs-heading-anchor" href="#Initialize-FPP-v1_demount-case">Initialize FPP v1_demount case</a><a id="Initialize-FPP-v1_demount-case-1"></a><a class="docs-heading-anchor-permalink" href="#Initialize-FPP-v1_demount-case" title="Permalink"></a></h3><p><a href="https://fuse.help/cases.html#FPP">FPP v1 demount case documentation</a></p><pre><code class="language- hljs">ini, act = FUSE.case_parameters(:FPP; version=:v1_demount, init_from=:scalars);
dd = FUSE.init(ini, act; do_plot=false);</code></pre><h3 id="Run-Actors-that-will-be-needed-for-balance-of-plant"><a class="docs-heading-anchor" href="#Run-Actors-that-will-be-needed-for-balance-of-plant">Run Actors that will be needed for balance of plant</a><a id="Run-Actors-that-will-be-needed-for-balance-of-plant-1"></a><a class="docs-heading-anchor-permalink" href="#Run-Actors-that-will-be-needed-for-balance-of-plant" title="Permalink"></a></h3><pre><code class="language- hljs">FUSE.ActorNeutronics(dd, act; do_plot=false)
FUSE.ActorDivertors(dd, act)
FUSE.ActorBlanket(dd, act);</code></pre><h3 id="Running-the-simple-brayton-cycle"><a class="docs-heading-anchor" href="#Running-the-simple-brayton-cycle">Running the simple brayton cycle</a><a id="Running-the-simple-brayton-cycle-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-simple-brayton-cycle" title="Permalink"></a></h3><p>Run the balance of plant actor, with for the simple case of &quot;brayton only&quot;, this is a generalized power cycle which does not optimize itself depending on the configuration</p><pre><code class="language- hljs">empty!(dd.balance_of_plant)
act.ActorThermalCycle.power_cycle_type=:brayton_only
FUSE.ActorBalanceOfPlant(dd, act; do_plot=true)
display(IMAS.freeze(dd.balance_of_plant))</code></pre><h3 id="Running-the-complex_brayton-file"><a class="docs-heading-anchor" href="#Running-the-complex_brayton-file">Running the complex_brayton file</a><a id="Running-the-complex_brayton-file-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-complex_brayton-file" title="Permalink"></a></h3><p><a href="https://fuse.help/actors.html#BalanceOfPlant">ActorBalanceOfPlant documentation</a> Run the balance of plant with the model &quot;complex<em>brayton&quot;. This configuration modifies the component order and operating temperatures to minimize the heat waste. For this case, the complex</em>brayton model has a thermal effeciency of 45%.  This model relies on high operating temperatures</p><pre><code class="language- hljs">empty!(dd.balance_of_plant)
act.ActorThermalCycle.power_cycle_type=:complex_brayton
FUSE.ActorBalanceOfPlant(dd, act; do_plot = true);
display(IMAS.freeze(dd.balance_of_plant))</code></pre><h2 id="Power-scan-for-different-power-cycles"><a class="docs-heading-anchor" href="#Power-scan-for-different-power-cycles">Power scan for different power cycles</a><a id="Power-scan-for-different-power-cycles-1"></a><a class="docs-heading-anchor-permalink" href="#Power-scan-for-different-power-cycles" title="Permalink"></a></h2><p>Basic fusion power scan that only runs the ActorBalanceOfPlant, to see what is the break-even point for the different power cycles that we support. This scan knows nothing about the plasma, it only cares about the thermal power that is extracted at the blanket and divertors.</p><pre><code class="language- hljs">act = FUSE.ParametersActors()
dd = IMAS.dd()

# minimal initialization to run ActorBalanceOfPlant
dd.core_profiles.time = [0.0]
resize!(dd.blanket.module, 1)
resize!(dd.blanket.module[1].time_slice)
dd.blanket.module[1].time_slice[].power_thermal_extracted = 0.0
resize!(dd.divertors.divertor, 1)
@ddtime dd.divertors.divertor[1].power_incident.data = 0.0

# assume 80% on blanket and rest on divertors
blanket_div_ratio = 0.8

# extent of the scan
POW = LinRange(6, 9, 100)

# run and plot
p=plot()
for cycle_type in [:brayton_only, :complex_brayton]#, :rankine_only
    
    Penet = Float64[]
    Ppump = Float64[]
    act.ActorThermalCycle.power_cycle_type=cycle_type
    for pow in POW
        dd.blanket.module[1].time_slice[].power_thermal_extracted = 10^(pow) * blanket_div_ratio
        @ddtime dd.divertors.divertor[1].power_incident.data = 10^(pow) * (1.0 - blanket_div_ratio)
        FUSE.ActorBalanceOfPlant(dd, act)
        push!(Penet, dd.balance_of_plant.power_electric_net[1])
        push!(Ppump, findfirst(:pumping, dd.balance_of_plant.power_electric_plant_operation.system).power[1])
    end

    pow0 = POW[argmin(abs.(Penet))]
    plot!(p, 10.0 .^ POW, Penet, xscale=:log10, label=&quot;$cycle_type $(round(10^pow0/1E6)) MW&quot;,
        xlabel=&quot;Power thermal extracted [W]&quot;, ylabel=&quot;Power_electric net [W]&quot;,legend=:topleft)
    #plot!(p, 10.0 .^ POW, -Ppump, primary=false)
    vline!(p, [10^pow0], label=&quot;&quot;, primary=false, ls=:dash)
end
hline!(p, [0.0], label=&quot;&quot;, color=:black)</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 19 August 2024 19:40">Monday 19 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
