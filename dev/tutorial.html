<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial Â· FUSE</title><meta name="title" content="Tutorial Â· FUSE"/><meta property="og:title" content="Tutorial Â· FUSE"/><meta property="twitter:title" content="Tutorial Â· FUSE"/><meta name="description" content="Documentation for FUSE."/><meta property="og:description" content="Documentation for FUSE."/><meta property="twitter:description" content="Documentation for FUSE."/><script async src="https://www.googletagmanager.com/gtag/js?id=G-65D8V8C8VQ"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-65D8V8C8VQ', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img class="docs-light-only" src="assets/logo.svg" alt="FUSE logo"/><img class="docs-dark-only" src="assets/logo-dark.svg" alt="FUSE logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Main</a></li><li><span class="tocitem">Learn</span><ul><li class="is-active"><a class="tocitem" href="tutorial.html">Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Basic-concepts"><span>Basic concepts</span></a></li><li class="toplevel"><a class="tocitem" href="#Let&#39;s-get-started!"><span>Let&#39;s get started!</span></a></li><li><a class="tocitem" href="#Starting-from-a-use-case"><span>Starting from a use-case</span></a></li><li><a class="tocitem" href="#Running-Actors"><span>Running Actors</span></a></li><li><a class="tocitem" href="#Whole-facility-design"><span>Whole facility design</span></a></li><li class="toplevel"><a class="tocitem" href="#Working-with-the-IMAS-data-structure"><span>Working with the IMAS data structure</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="pubs.html">Publications</a></li></ul></li><li><a class="tocitem" href="cases.html">Use Cases</a></li><li><span class="tocitem">Actors</span><ul><li><a class="tocitem" href="actors.html">List of actors</a></li><li><a class="tocitem" href="act.html">act parameters</a></li></ul></li><li><span class="tocitem">Initialization</span><ul><li><a class="tocitem" href="inits.html">Init routines</a></li><li><a class="tocitem" href="ini.html">ini parameters</a></li></ul></li><li><a class="tocitem" href="dd.html">Data Structure</a></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="deps.html">Ecosystem</a></li><li><a class="tocitem" href="develop.html">Contributing</a></li></ul></li><li><span class="tocitem">Install</span><ul><li><a class="tocitem" href="install.html">Install FUSE</a></li><li><a class="tocitem" href="install_saga.html">on SAGA</a></li><li><a class="tocitem" href="install_omega.html">on OMEGA</a></li></ul></li><li><span class="tocitem">License</span><ul><li><a class="tocitem" href="license.html">License</a></li><li><a class="tocitem" href="notice.html">Notice</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Learn</a></li><li class="is-active"><a href="tutorial.html">Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tutorial.html">Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ProjectTorreyPines/FUSE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ProjectTorreyPines/FUSE.jl/blob/master/docs/src/tutorial.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="FUSE-Introductory-Tutorial"><a class="docs-heading-anchor" href="#FUSE-Introductory-Tutorial">FUSE Introductory Tutorial</a><a id="FUSE-Introductory-Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#FUSE-Introductory-Tutorial" title="Permalink"></a></h1><p>Download this tutorial from the <a href="https://github.com/ProjectTorreyPines/FuseExamples/blob/master/tutorial.ipynb">FuseExamples repository</a></p><h2 id="Basic-concepts"><a class="docs-heading-anchor" href="#Basic-concepts">Basic concepts</a><a id="Basic-concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-concepts" title="Permalink"></a></h2><p>To make sense of this tutorial, you&#39;ll need to know the following organization concepts of FUSE:</p><ol><li><strong>ğŸ“‚ Data storage</strong>: All data is stored in the <code>dd</code> structure, which follows the ITER IMAS ontology.</li><li><strong>ğŸ§  Actors</strong>: The core components of FUSE simulations are physics and engineering actors.</li><li><strong>ğŸ•¹ï¸ Control</strong>: Actor functionality is governed by <code>act</code> parameters.</li><li><strong>ğŸš€ Initialization</strong>: The data structure can be initialized from 0D <code>ini</code> parameters.</li><li><strong>ğŸ”§ Use cases</strong>: FUSE includes templates for various machines (e.g., FPP, ITER, ARC).</li><li><strong>ğŸ”„ Workflows</strong>: Self-contained studies and optimizations are conducted via workflows, typically involving multiple FUSE simulations.</li><li><strong>ğŸŒ Interoperability</strong>: FUSE interfaces with existing modeling tools like OMFIT/OMAS and the IMAS ecosystem.</li></ol><p>A diagram illustrating these concepts is provided below: <img src="attachment:5ff4862c-b856-485b-9649-02fec5bdd0d7.png" alt="image.png"/></p><h1 id="Let&#39;s-get-started!"><a class="docs-heading-anchor" href="#Let&#39;s-get-started!">Let&#39;s get started!</a><a id="Let&#39;s-get-started!-1"></a><a class="docs-heading-anchor-permalink" href="#Let&#39;s-get-started!" title="Permalink"></a></h1><hr/><p><strong>NOTE</strong>: Julia is a Just In Time (JIT) programming language. The first time something is executed it will take longer because of the compilation process. Subsequent calls the the same code will be blazingly fast.</p><hr/><p>Import the necessary packages</p><pre><code class="language-julia hljs">using Plots # for plotting
using FUSE # this will also import IMAS in the current namespace</code></pre><h2 id="Starting-from-a-use-case"><a class="docs-heading-anchor" href="#Starting-from-a-use-case">Starting from a use-case</a><a id="Starting-from-a-use-case-1"></a><a class="docs-heading-anchor-permalink" href="#Starting-from-a-use-case" title="Permalink"></a></h2><p>FUSE comes with some predefined <a href="https://fuse.help/stable/cases.html">use-cases</a>, some of which are used for regression testing.</p><p>Note that some use cases are for non-nuclear experiments and certain Actors like Blankets or BalanceOfPlant will not perform any actions.</p><p>Here&#39;s the list of supported use-cases. These can be customized and you will also be able to build your own.</p><pre><code class="language-julia hljs">methods(FUSE.case_parameters)</code></pre># 26 methods for generic function <b>case_parameters</b> from [35mFUSE[39m:<ul><li> case_parameters(::<b>Val{:baby_MANTA}</b>; <i>flux_matcher</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/baby_MANTA.jl#L4" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/baby_MANTA.jl:4</a></li> <li> case_parameters(::<b>Val{:ITER}</b>; <i>init_from, boundary_from, ne_setting, time_dependent</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/ITER.jl#L11" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/ITER.jl:11</a></li> <li> case_parameters(::<b>Val{:EXCITE}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/EXCITE.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/EXCITE.jl:6</a></li> <li> case_parameters(::<b>Val{:D3D}</b>, scenario::<b>Symbol</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/D3D.jl#L320" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/D3D.jl:320</a></li> <li> case_parameters(::<b>Val{:D3D}</b>, shot::<b>Int64</b>; <i>fit_profiles, EFIT_tree, PROFILES_tree, CER_analysis_type, time_averaging, rho_averaging, new_impurity_match_power_rad, omega_user, omega_omfit_root, omega_omas_root, use_local_cache</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/D3D.jl#L18" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/D3D.jl:18</a></li> <li> case_parameters(::<b>Val{:D3D}</b>, dd::<b>IMASdd.dd</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/D3D.jl#L299" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/D3D.jl:299</a></li> <li> case_parameters(::<b>Val{:D3D}</b>, ods_file::<b>AbstractString</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/D3D.jl#L282" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/D3D.jl:282</a></li> <li> case_parameters(::<b>Val{:KSTAR}</b>; <i>init_from</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/KSTAR.jl#L5" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/KSTAR.jl:5</a></li> <li> case_parameters(::<b>Val{:KDEMO}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/KDEMO.jl#L4" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/KDEMO.jl:4</a></li> <li> case_parameters(::<b>Val{:STEP}</b>; <i>init_from, pf_from</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/STEP.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/STEP.jl:6</a></li> <li> case_parameters(::<b>Val{:SPARC}</b>; <i>init_from</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/SPARC.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/SPARC.jl:6</a></li> <li> case_parameters(::<b>Val{:CAT}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/CAT.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/CAT.jl:6</a></li> <li> case_parameters(::<b>Val{:FIRST}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/FIRST.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/FIRST.jl:6</a></li> <li> case_parameters(::<b>Val{:UNIT}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/UNIT.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/UNIT.jl:6</a></li> <li> case_parameters(::<b>Val{:ARC}</b>; <i>flux_matcher</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/ARC.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/ARC.jl:6</a></li> <li> case_parameters(::<b>Val{:DTT}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/DTT.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/DTT.jl:6</a></li> <li> case_parameters(::<b>Val{:KDEMO_compact}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/KDEMO.jl#L96" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/KDEMO.jl:96</a></li> <li> case_parameters(::<b>Val{:MASTU}</b>; <i>init_from</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/MASTU.jl#L5" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/MASTU.jl:5</a></li> <li> case_parameters(::<b>Val{:MANTA}</b>; <i>flux_matcher</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/MANTA.jl#L10" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/MANTA.jl:10</a></li> <li> case_parameters(::<b>Val{:HDB5}</b>; <i>tokamak, case, database_case, shot, verbose</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/HDB5.jl#L9" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/HDB5.jl:9</a></li> <li> case_parameters(::<b>Val{:JET}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/JET.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/JET.jl:6</a></li> <li> case_parameters(::<b>Val{:NSTX}</b>; <i>init_from</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/NSTX.jl#L5" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/NSTX.jl:5</a></li> <li> case_parameters(::<b>Val{:D3D_machine}</b>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/D3D.jl#L376" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/D3D.jl:376</a></li> <li> case_parameters(::<b>Val{:FPP}</b>; <i>flux_matcher</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/FPP.jl#L6" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/FPP.jl:6</a></li> <li> case_parameters(case::<b>Symbol</b>, args...; <i>kw...</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/_cases.jl#L36" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/_cases.jl:36</a></li> <li> case_parameters(data_row::<b>DataFrames.DataFrameRow</b>; <i>verbose</i>) in FUSE at <a href="https://github.com/ProjectTorreyPines/FUSE.jl/tree/f3adfd39f8a27b787074d3a3536f615e654c9456//src/cases/HDB5.jl#L18" target="_blank">/home/runner/work/FUSE.jl/FUSE.jl/src/cases/HDB5.jl:18</a></li> </ul><p>Get initial parameters (<code>ini</code>) and actions (<code>act</code>) for a given use-case, let&#39;s use KDEMO for example</p><pre><code class="language-julia hljs">ini, act = FUSE.case_parameters(:KDEMO);</code></pre><p>The <code>ini</code> data structure contains 0D parameters that will be used to bootstrap the <code>dd</code> with plausible data.</p><p>The <a href="https://fuse.help/stable/ini.html"><code>ini</code> parameters</a> can be modified.</p><pre><code class="language-julia hljs">ini.equilibrium.B0 = 7.8
ini.equilibrium.R0 = 6.5;</code></pre><p>The <code>act</code> data structure contains parameters that define how the actors (ie the models) will behave.</p><p>The <a href="https://fuse.help/stable/act.html"><code>act</code> parameters</a> can also be modified.</p><pre><code class="language-julia hljs">act.ActorCoreTransport.model = :FluxMatcher;</code></pre><p><code>ini</code> and <code>act</code> can now be used to initialize the data dictionary (<code>dd</code>) using the 0D parameters.</p><p><strong>NOTE:</strong> <code>init()</code> does not return a self-consistent solution, just a plausible starting point to initialize our simulations!</p><pre><code class="language-julia hljs">dd = IMAS.dd() # an empty dd
FUSE.init(dd, ini, act);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: Equilibrium
actors:  TEQUILA
actors: CXbuild
actors: HCD
actors:  SimpleEC
actors:  SimpleIC
actors:  NeutralFueling
actors: Current
actors:  QED
actors: PassiveStructures</code></pre><p>Let&#39;s see what we got</p><pre><code class="language-julia hljs">plot(dd.build)

plot(dd.equilibrium)

plot(dd.core_profiles)

plot(dd.core_sources)</code></pre><img src="tutorial-abd927d9.svg" alt="Example block output"/><p>We can <code>@checkin</code> and <code>@checkout</code> variables with an associated tag.</p><p>This is handy to save and restore (checkpoint) our progress without having to always start from scratch (we&#39;ll use this later).</p><pre><code class="language-julia hljs">@checkin :init dd ini act</code></pre><h2 id="Running-Actors"><a class="docs-heading-anchor" href="#Running-Actors">Running Actors</a><a id="Running-Actors-1"></a><a class="docs-heading-anchor-permalink" href="#Running-Actors" title="Permalink"></a></h2><p>Let&#39;s now run a series of actors and play around with plotting to get a sense of what each individual actor does.</p><p>Here&#39;s how we can restore things back to after the initialization stage (in case we did anything else in between)</p><pre><code class="language-julia hljs">@checkout :init dd ini act</code></pre><p>Actors in FUSE can be executed by passing two arguments to them: <code>dd</code> and <code>act</code>.</p><p>Let&#39;s start by positioning the PF coils, so that we stand a chance to reproduce the desired plasma shape. This will be important to ensure the stability of the <code>ActorStationaryPlasma</code> that we are going to run next.</p><pre><code class="language-julia hljs">FUSE.ActorPFdesign(dd, act; do_plot=true); # instead of setting `act.ActorPFdesign.do_plot=true` we can just pass `do_plot=true` as argument without chaning `act`</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: PFdesign</code></pre><p>The <code>ActorStationaryPlasma</code> iterates between plasma transport, pedestal, equilibrium and sources to return a self-consistent plasma solution</p><pre><code class="language-julia hljs">peq = plot(dd.equilibrium; label=&quot;before&quot;)
pcp = plot(dd.core_profiles; color=:gray, label=&quot;before&quot;)
#act.ActorFluxMatcher.verbose = true
act.ActorFluxMatcher.algorithm = :anderson
#act.ActorFluxMatcher.step_size = 0.1
FUSE.ActorStationaryPlasma(dd, act);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: StationaryPlasma
actors:  --------------- 1/5
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:    Pedestal
actors:     EPED
actors:    FluxCalculator
actors:     TGLF
actors:     Neoclassical
actors:  Current
actors:   QED
actors:  Sawteeth
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 1/5 @ 595.88%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:    Pedestal
actors:     EPED
actors:    FluxCalculator
actors:     TGLF
actors:     Neoclassical
actors:  Current
actors:   QED
actors:  Sawteeth
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 2/5 @ 570.38%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:    Pedestal
actors:     EPED
actors:    FluxCalculator
actors:     TGLF
actors:     Neoclassical
actors:  Current
actors:   QED
actors:  Sawteeth
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 3/5 @ 303.70%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:    Pedestal
actors:     EPED
actors:    FluxCalculator
actors:     TGLF
actors:     Neoclassical
actors:  Current
actors:   QED
actors:  Sawteeth
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 4/5 @ 117.23%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:    Pedestal
actors:     EPED
actors:    FluxCalculator
actors:     TGLF
actors:     Neoclassical
actors:  Current
actors:   QED
actors:  Sawteeth
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 5/5 @ 50.81%</code></pre><p>we can compare equilibrium before and after the self-consistency loop</p><pre><code class="language-julia hljs">plot!(peq, dd.equilibrium; label=&quot;after&quot;)</code></pre><img src="tutorial-987eacba.svg" alt="Example block output"/><p>we can compare core_profiles before and after the self-consistency loop</p><pre><code class="language-julia hljs">plot!(pcp, dd.core_profiles; label=&quot;after&quot;)</code></pre><img src="tutorial-444bc766.svg" alt="Example block output"/><p>here are the sources</p><pre><code class="language-julia hljs">plot(dd.core_sources)</code></pre><img src="tutorial-abf3eca1.svg" alt="Example block output"/><p>and the flux-matched transport</p><pre><code class="language-julia hljs">plot(dd.core_transport)</code></pre><img src="tutorial-d47ad47f.svg" alt="Example block output"/><p>HFS sizing actor changes the thickness of the OH and TF layers on the high field side to satisfy current and stresses constraints</p><pre><code class="language-julia hljs">plot(dd.build)
FUSE.ActorHFSsizing(dd, act);
plot!(dd.build; cx=false)</code></pre><img src="tutorial-0f9b5c19.svg" alt="Example block output"/><p>The stresses on the center stack are stored in the <code>solid_mechanics</code> IDS</p><pre><code class="language-julia hljs">plot(dd.solid_mechanics.center_stack.stress)</code></pre><img src="tutorial-b169ad07.svg" alt="Example block output"/><p>LFS sizing actors change location of the outer TF leg to meet ripple requirements</p><pre><code class="language-julia hljs">plot(dd.build)
FUSE.ActorLFSsizing(dd, act);
plot!(dd.build; cx=false)</code></pre><img src="tutorial-6f5927b7.svg" alt="Example block output"/><p>A custom <code>show()</code> method is defined to print the summary of <code>dd.build.layer</code></p><pre><code class="language-julia hljs">dd.build.layer</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">23Ã—10 DataFrame
 Row â”‚ group   details                            type      Î”R          R_start   R_end     material      area        volume     shape
     â”‚<span class="sgr90"> String  String                             String    Float64     Float64   Float64   String        Float64     Float64    String
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ in                                                   1.32527      0.0       1.32527  steel          20.0726      98.9942  rectangle
   2 â”‚ in                                         oh        0.305673     1.32527   1.63095  nb3sn           6.9632      80.5952  rectangle
   3 â”‚ hfs                                        tf        1.667        1.63095   3.29794  nb3sn_kdemo    42.9246     889.465   convex hull
   4 â”‚ hfs     gap tf vacuum vessel                         0.0          3.29794   3.29794  vacuum          7.46559    490.871   double ellipse
   5 â”‚ hfs     vacuum  outer                      vessel    0.0982993    3.29794   3.39624  steel           3.06115    124.717   negative offset
   6 â”‚ hfs     gap water                                    0.147449     3.39624   3.54369  water           4.47786    182.552   negative offset
   7 â”‚ hfs     vacuum  inner                      vessel    0.0982993    3.54369   3.64199  steel           2.90933    118.686   negative offset
   8 â”‚ hfs     gap high temp shield vacuum vessâ€¦            0.00982993   3.64199   3.65182  vacuum          0.287593    11.7359  negative offset
   9 â”‚ hfs     high temp                          shield    0.196599     3.65182   3.84842  steel           5.62432    229.652   negative offset
  10 â”‚ hfs                                        blanket   0.373538     3.84842   4.22196  lithium_lead   20.8557     951.46    negative offset
  11 â”‚ hfs     first                              wall      0.0196599    4.22196   4.24162  tungsten        1.02635     34.1644  offset
  12 â”‚ lhfs                                       plasma    4.51651      4.24162   8.75812  plasma         32.1335    1252.4
  13 â”‚ lfs     first                              wall      0.0196599    8.75812   8.77778  tungsten        1.02635     34.1644  offset
  14 â”‚ lfs                                        blanket   1.17959      8.77778   9.95738  lithium_lead   20.8557     951.46    negative offset
  15 â”‚ lfs     high temp                          shield    0.196599     9.95738  10.154    steel           5.62432    229.652   negative offset
  16 â”‚ lfs     gap high temp shield vacuum vessâ€¦            0.0442026   10.154    10.1982   vacuum          0.287593    11.7359  negative offset
  17 â”‚ lfs     vacuum  inner                      vessel    0.0982993   10.1982   10.2965   steel           2.90933    118.686   negative offset
  18 â”‚ lfs     gap water                                    0.147449    10.2965   10.4439   water           4.47786    182.552   negative offset
  19 â”‚ lfs     vacuum  outer                      vessel    0.0982993   10.4439   10.5422   steel           3.06115    124.717   negative offset
  20 â”‚ lfs     gap tf vacuum vessel                         0.775582    10.5422   11.3178   vacuum          7.46559    490.871   double ellipse
  21 â”‚ lfs                                        tf        1.667       11.3178   12.9848   nb3sn_kdemo    42.9246     889.465   convex hull
  22 â”‚ out                                                  1.96599      0.0      14.9508   vacuum        164.187     8377.39
  23 â”‚ out                                        cryostat  0.0982993    0.0      15.0491   steel           4.86738    309.732   silo</span></span></code></pre><p>ActorHFSsizing and ActorLFSsizing only change the layer&#39;s thicknesses, so we then need to trigger a build of the 2D cross-sections after them:</p><pre><code class="language-julia hljs">FUSE.ActorCXbuild(dd, act);
plot(dd.build)</code></pre><img src="tutorial-4e5a5f02.svg" alt="Example block output"/><p>Generate passive structures information (for now the vacuum vessel)</p><pre><code class="language-julia hljs">FUSE.ActorPassiveStructures(dd, act)
plot(dd.pf_passive)</code></pre><img src="tutorial-a45891bc.svg" alt="Example block output"/><p>We can now give the PF coils their final position given the new build</p><pre><code class="language-julia hljs">actor = FUSE.ActorPFdesign(dd, act);
plot(actor) # some actors define their own plot</code></pre><img src="tutorial-5c4bac57.svg" alt="Example block output"/><p>With information about both pf<em>active and pf</em>passive we can now evaluate vertical stability</p><pre><code class="language-julia hljs">FUSE.ActorVerticalStability(dd, act)
IMAS.freeze(dd.mhd_linear)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">mhd_linear [DETACHED]</span>
â”œâ”€ time<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [s]</span></span>
â””â”€ <span class="sgr1">time_slice</span>
   â””â”€ <span class="sgr1">1</span>
      â”œâ”€ time<span class="sgr31"> â¡ 0<span class="sgr1"> [s]</span></span>
      â””â”€ <span class="sgr1">toroidal_mode</span>
         â”œâ”€ <span class="sgr1">1</span>
         â”‚  â”œâ”€ n_tor<span class="sgr31"> â¡ </span><span class="sgr33">0</span>
         â”‚  â”œâ”€ <span class="sgr1">perturbation_type</span>
         â”‚  â”‚  â”œâ”€ description<span class="sgr31"> â¡ </span><span class="sgr35">&quot;Vertical stability margin &gt; 0.15 for stability&quot;</span>
         â”‚  â”‚  â””â”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;m_s&quot;</span>
         â”‚  â””â”€ stability_metric<span class="sgr31"> â¡ 0.177494</span>
         â””â”€ <span class="sgr1">2</span>
            â”œâ”€ n_tor<span class="sgr31"> â¡ </span><span class="sgr33">0</span>
            â”œâ”€ <span class="sgr1">perturbation_type</span>
            â”‚  â”œâ”€ description<span class="sgr31"> â¡ </span><span class="sgr35">&quot;Normalized vertical growth rate &lt; 10 for stability&quot;</span>
            â”‚  â””â”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;Î³Ï„&quot;</span>
            â””â”€ stability_metric<span class="sgr31"> â¡ 6.76771</span>
</code></pre><p>The <code>ActorNeutronics</code> calculates the heat flux on the first wall</p><pre><code class="language-julia hljs">FUSE.ActorNeutronics(dd, act);
p = plot(; layout=2, size=(900, 350))
plot!(p, dd.neutronics.time_slice[].wall_loading, subplot=1)
plot!(p, FUSE.define_neutrons(dd, 100000)[1], dd.equilibrium.time_slice[]; subplot=1, colorbar_entry=false)
plot!(p, dd.neutronics.time_slice[].wall_loading; cx=false, subplot=2, ylabel=&quot;&quot;)</code></pre><img src="tutorial-a7ab56c4.svg" alt="Example block output"/><p>The <code>ActorBlanket</code> will change the thickess of the first wall, breeder, shield, and Li6 enrichment to achieve target TBR</p><pre><code class="language-julia hljs">FUSE.ActorBlanket(dd, act);
print_tree(IMAS.freeze(dd.blanket); maxdepth=5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: Blanket
blanket [DETACHED]
â”œâ”€ module
â”‚  â””â”€ 1
â”‚     â”œâ”€ layer
â”‚     â”‚  â”œâ”€ 1
â”‚     â”‚  â”‚  â”œâ”€ material â¡ &quot;tungsten&quot;
â”‚     â”‚  â”‚  â”œâ”€ midplane_thickness â¡ 0.01996 [m]
â”‚     â”‚  â”‚  â””â”€ name â¡ &quot;lfs first wall&quot;
â”‚     â”‚  â”œâ”€ 2
â”‚     â”‚  â”‚  â”œâ”€ material â¡ &quot;lithium-lead: Li6/7=90.000%&quot;
â”‚     â”‚  â”‚  â”œâ”€ midplane_thickness â¡ 1.28817 [m]
â”‚     â”‚  â”‚  â””â”€ name â¡ &quot;lfs blanket&quot;
â”‚     â”‚  â””â”€ 3
â”‚     â”‚     â”œâ”€ material â¡ &quot;steel&quot;
â”‚     â”‚     â”œâ”€ midplane_thickness â¡ 0.0877212 [m]
â”‚     â”‚     â””â”€ name â¡ &quot;lfs high temp shield&quot;
â”‚     â”œâ”€ name â¡ &quot;blanket&quot;
â”‚     â””â”€ time_slice
â”‚        â””â”€ 1
â”‚           â”œâ”€ peak_escape_flux â¡ 214718 [W/m^2]
â”‚           â”œâ”€ peak_wall_flux â¡ 1.07186e+06 [W/m^2]
â”‚           â”œâ”€ power_incident_neutrons â¡ 1.12124e+07 [W]
â”‚           â”œâ”€ power_incident_radiated â¡ 0 [W]
â”‚           â”œâ”€ power_thermal_extracted â¡ 1.34548e+07 [W]
â”‚           â”œâ”€ power_thermal_neutrons â¡ 1.34548e+07 [W]
â”‚           â”œâ”€ power_thermal_radiated â¡ 0 [W]
â”‚           â”œâ”€ time â¡ 0 [s]
â”‚           â””â”€ tritium_breeding_ratio â¡ 1.66838
â”œâ”€ time â¡ [0] [s]
â””â”€ tritium_breeding_ratio â¡ [0.0750628]</code></pre><p>The <code>ActorDivertors</code> actor calculates the divertors heat flux</p><pre><code class="language-julia hljs">FUSE.ActorDivertors(dd, act);
print_tree(IMAS.freeze(dd.divertors); maxdepth=4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: Divertors
divertors [DETACHED]
â”œâ”€ divertor
â”‚  â””â”€ 1
â”‚     â”œâ”€ power_black_body
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_conducted
â”‚     â”‚  â”œâ”€ data â¡ [1.25319e+08] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_convected
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_currents
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_incident
â”‚     â”‚  â”œâ”€ data â¡ [3.75277e+07] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_neutrals
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_radiated
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_recombination_neutrals
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_recombination_plasma
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_thermal_extracted
â”‚     â”‚  â”œâ”€ data â¡ [3.75277e+07] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â””â”€ target
â”‚        â”œâ”€ 1
â”‚        â”‚  â‹®
â”‚        â”‚
â”‚        â””â”€ 2
â”‚           â‹®
â”‚
â””â”€ time â¡ [0] [s]</code></pre><p>The <code>ActorBalanceOfPlant</code> calculates the optimal cooling flow rates for the heat sources (breeder, divertor, and wall) and get an efficiency for the electricity conversion cycle</p><pre><code class="language-julia hljs">FUSE.ActorBalanceOfPlant(dd, act);
IMAS.freeze(dd.balance_of_plant)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">balance_of_plant [DETACHED]</span>
â”œâ”€ Q_plant<span class="sgr31"> â¡ </span><span class="sgr32">[0.138457]</span>
â”œâ”€ power_electric_net<span class="sgr31"> â¡ </span><span class="sgr32">[-1.24924e+08]<span class="sgr1"> [W]</span></span>
â”œâ”€ <span class="sgr1">power_electric_plant_operation</span>
â”‚  â”œâ”€ <span class="sgr1">system</span>
â”‚  â”‚  â”œâ”€ <span class="sgr1">1</span>
â”‚  â”‚  â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">1</span>
â”‚  â”‚  â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;HCD&quot;</span>
â”‚  â”‚  â”‚  â”œâ”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[1e+08]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚  â””â”€ <span class="sgr1">subsystem</span>
â”‚  â”‚  â”‚     â”œâ”€ <span class="sgr1">1</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">1</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;nbi&quot;</span>
â”‚  â”‚  â”‚     â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚     â”œâ”€ <span class="sgr1">2</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">2</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;ec_launchers&quot;</span>
â”‚  â”‚  â”‚     â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[5e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚     â”œâ”€ <span class="sgr1">3</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">3</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;ic_antennas&quot;</span>
â”‚  â”‚  â”‚     â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[5e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚     â””â”€ <span class="sgr1">4</span>
â”‚  â”‚  â”‚        â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">4</span>
â”‚  â”‚  â”‚        â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;lh_antennas&quot;</span>
â”‚  â”‚  â”‚        â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”œâ”€ <span class="sgr1">2</span>
â”‚  â”‚  â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">3</span>
â”‚  â”‚  â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;cryostat&quot;</span>
â”‚  â”‚  â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[3e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”œâ”€ <span class="sgr1">3</span>
â”‚  â”‚  â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">4</span>
â”‚  â”‚  â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;tritium_handling&quot;</span>
â”‚  â”‚  â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[1.5e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â””â”€ <span class="sgr1">4</span>
â”‚  â”‚     â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">6</span>
â”‚  â”‚     â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;pf_active&quot;</span>
â”‚  â”‚     â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [W]</span></span>
â”‚  â””â”€ total_power<span class="sgr31"> â¡ </span><span class="sgr32">[1.45e+08]<span class="sgr1"> [W]</span></span>
â”œâ”€ <span class="sgr1">power_plant</span>
â”‚  â”œâ”€ <span class="sgr1">heat_load</span>
â”‚  â”‚  â”œâ”€ breeder<span class="sgr31"> â¡ </span><span class="sgr32">[1.34548e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”œâ”€ divertor<span class="sgr31"> â¡ </span><span class="sgr32">[3.75277e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â””â”€ wall<span class="sgr31"> â¡ </span><span class="sgr32">[3.74821e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”œâ”€ power_cycle_type<span class="sgr31"> â¡ </span><span class="sgr35">&quot;rankine&quot;</span>
â”‚  â”œâ”€ power_electric_generated<span class="sgr31"> â¡ </span><span class="sgr32">[2.00762e+07]<span class="sgr1"> [W]</span></span>
â”‚  â””â”€ total_heat_supplied<span class="sgr31"> â¡ </span><span class="sgr32">[8.84646e+07]<span class="sgr1"> [W]</span></span>
â”œâ”€ thermal_efficiency_plant<span class="sgr31"> â¡ </span><span class="sgr32">[0.226941]</span>
â””â”€ time<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [s]</span></span>
</code></pre><p><code>ActorCosting</code> will break down the capital and operational costs</p><pre><code class="language-julia hljs">FUSE.ActorCosting(dd, act)
plot(dd.costing)</code></pre><img src="tutorial-b6c3bef1.svg" alt="Example block output"/><p>Let&#39;s checkpoint our results</p><pre><code class="language-julia hljs">@checkin :manual dd ini act</code></pre><h2 id="Whole-facility-design"><a class="docs-heading-anchor" href="#Whole-facility-design">Whole facility design</a><a id="Whole-facility-design-1"></a><a class="docs-heading-anchor-permalink" href="#Whole-facility-design" title="Permalink"></a></h2><p>Here we restore the <code>:init</code> checkpoint that we had previously stored. Resetting any changes to <code>dd</code>, <code>ini</code>, and <code>act</code> that we did in the meantime.</p><pre><code class="language-julia hljs">@checkout :init dd ini act</code></pre><p>Actors can call other actors, creating workflows. For example, the <code>ActorWholeFacility</code> can be used to to get a self-consistent stationary whole facility design.</p><pre><code class="language-julia hljs">FUSE.ActorWholeFacility(dd, act);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: WholeFacility
actors:  PFdesign
actors:  StationaryPlasma
actors:   --------------- 1/5
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:     Pedestal
actors:      EPED
actors:     FluxCalculator
actors:      TGLF
actors:      Neoclassical
actors:   Current
actors:    QED
actors:   Sawteeth
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 1/5 @ 595.84%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:     Pedestal
actors:      EPED
actors:     FluxCalculator
actors:      TGLF
actors:      Neoclassical
actors:   Current
actors:    QED
actors:   Sawteeth
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 2/5 @ 569.99%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:     Pedestal
actors:      EPED
actors:     FluxCalculator
actors:      TGLF
actors:      Neoclassical
actors:   Current
actors:    QED
actors:   Sawteeth
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 3/5 @ 347.42%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:     Pedestal
actors:      EPED
actors:     FluxCalculator
actors:      TGLF
actors:      Neoclassical
actors:   Current
actors:    QED
actors:   Sawteeth
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 4/5 @ 194.69%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:     Pedestal
actors:      EPED
actors:     FluxCalculator
actors:      TGLF
actors:      Neoclassical
actors:   Current
actors:    QED
actors:   Sawteeth
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 5/5 @ 159.14%
â”Œ Warning: Max number of iterations (5) has been reached with convergence error of (1)[0.298, 0.285, 0.174, 0.097, 0.08](5) compared to threshold of 0.05
â”” @ FUSE ~/work/FUSE.jl/FUSE.jl/src/actors/compound/stationary_plasma_actor.jl:237
actors:  HFSsizing
actors:   FluxSwing
actors:   Stresses
actors:  LFSsizing
actors:  CXbuild
actors:  PFdesign
actors:  Equilibrium
actors:   TEQUILA
actors:  CXbuild
actors:  Neutronics
actors:  Blanket
actors:  CXbuild
actors:  PassiveStructures
actors:  Divertors
actors:  PlasmaLimits
actors:   VerticalStability
actors:   TroyonBetaNN
actors:  BalanceOfPlant
actors:   ThermalPlant
actors:   PowerNeeds
actors:  Costing
actors:   CostingARIES</code></pre><p>Let&#39;s check what we got at a glance with the <code>FUSE.digest(dd)</code> function:</p><pre><code class="language-julia hljs">FUSE.digest(dd)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GEOMETRY                                EQUILIBRIUM                             TEMPERATURES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
R0 â†’ 6.5 [m]                            B0 â†’ 7.8 [T]                            Te0 â†’ 20.7 [keV]
a â†’ 2.01 [m]                            ip â†’ 12.7 [MA]                          Ti0 â†’ 19.4 [keV]
1/Ïµ â†’ 3.24                              q95 â†’ 6.14                              &lt;Te&gt; â†’ 8.97 [keV]
Îº â†’ 2                                   &lt;Bpol&gt; â†’ 0.802 [T]                      &lt;Ti&gt; â†’ 8.1 [keV]
Î´ â†’ 0.588                               Î²pol_MHD â†’ 0.81                         Te0/&lt;Te&gt; â†’ 2.31
Î¶ â†’ -0.0136                             Î²tor_MHD â†’ 0.00882                      Ti0/&lt;Ti&gt; â†’ 2.39
Volume â†’ 930 [mÂ³]                       Î²n_MHD â†’ 1.08
Surface â†’ 759 [mÂ²]

DENSITIES                               PRESSURES                               TRANSPORT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ne0 â†’ 9.36e+19 [mâ»Â³]                    P0 â†’ 0.57 [MPa]                         Ï„e â†’ 2.39 [s]
ne_ped â†’ 6.8e+19 [mâ»Â³]                  &lt;P&gt; â†’ 0.214 [MPa]                       Ï„e_exp â†’ 1.84 [s]
ne_line â†’ 8.38e+19 [mâ»Â³]                P0/&lt;P&gt; â†’ 2.66                           H98y2 â†’ 0.888
&lt;ne&gt; â†’ 7.62e+19 [mâ»Â³]                   Î²n â†’ 1.09                               H98y2_exp â†’ 0.819
ne0/&lt;ne&gt; â†’ 1.23                         Î²n_th â†’ 1.09                            Hds03 â†’ 0.657
fGW â†’ 0.834                                                                     Hds03_exp â†’ 0.585
zeff_ped â†’ 2                                                                    Ï„Î±_thermalization â†’ 0.954 [s]
&lt;zeff&gt; â†’ 2                                                                      Ï„Î±_slowing_down â†’ 1.12 [s]
impurities â†’ DT Ne20 He4

SOURCES                                 EXHAUST                                 CURRENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pec â†’ 50 [MW]                           Psol â†’ 125 [MW]                         ip_bs_aux_ohm â†’ 13 [MA]
rho0_ec â†’ 0.56 [MW]                     PLH â†’ 135 [MW]                          ip_ni â†’ 6.24 [MA]
Pnbi â†’ NaN [MW]                         Bpol_omp â†’ 1.12 [T]                     ip_bs â†’ 3.22 [MA]
Enbi1 â†’ NaN [MeV]                       Î»q â†’ 0.972 [mm]                         ip_aux â†’ 3.01 [MA]
Pic â†’ 50 [MW]                           qpol â†’ 2.4e+03 [MW/mÂ²]                  ip_ohm â†’ 6.79 [MA]
Plh â†’ NaN [MW]                          qpar â†’ 1.31e+04 [MW/mÂ²]                 ejima â†’ 0.4
Paux_tot â†’ 100 [MW]                     P/R0 â†’ 19.2 [MW/m]                      flattop â†’ 0.7 [Hours]
PÎ± â†’ 61 [MW]                            PB/R0 â†’ 150 [MW T/m]
Pohm â†’ 0.523 [MW]                       PBp/R0 â†’ 15.4 [MW T/m]
Pheat â†’ 162 [MW]                        PBÏµ/R0q95 â†’ 7.53 [MW T/m]
Prad_tot â†’ -36.9 [MW]                   neutrons_peak â†’ 0.392 [MW/mÂ²]

BOP                                     BUILD                                   COSTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pfusion â†’ 305 [MW]                      PF_material â†’ nb3sn                     capital_cost â†’ 6.88 [$B]
Qfusion â†’ 3.05                          TF_material â†’ nb3sn_kdemo               levelized_CoE â†’ Inf [$/kWh]
thermal_cycle_type â†’ rankine            OH_material â†’ nb3sn                     TF_of_total â†’ 16.8 [%]
thermal_efficiency_plant â†’ 22.7 [%]     TF_max_b â†’ 15.4 [T]                     BOP_of_total â†’ 1.82 [%]
thermal_efficiency_cycle â†’ NaN [%]      OH_max_b â†’ 14.9 [T]                     blanket_of_total â†’ 20 [%]
power_electric_generated â†’ 19.5 [MW]    TF_j_margin â†’ 4.99                      cryostat_of_total â†’ 2.95 [%]
Pelectric_net â†’ -125 [MW]               OH_j_margin â†’ 1.4
Qplant â†’ 0.135                          TF_stress_margin â†’ 3.04
TBR â†’ 0.0747                            OH_stress_margin â†’ 1.23

@ time = 0.0 [s]
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
GKS: could not find font middle.ttf
â€‹
â€‹
â€‹</code></pre><p>Like before we can checkpoint results for later use</p><pre><code class="language-julia hljs">@checkin :awf dd ini act</code></pre><h1 id="Working-with-the-IMAS-data-structure"><a class="docs-heading-anchor" href="#Working-with-the-IMAS-data-structure">Working with the IMAS data structure</a><a id="Working-with-the-IMAS-data-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-the-IMAS-data-structure" title="Permalink"></a></h1><p>See the IMAS tutorial https://github.com/ProjectTorreyPines/FuseExamples/blob/master/tutorial_imas.ipynb</p><p>Understanding how to work with the IMAS data structure is a must for working within the FUSE ecosystem!</p><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>Snapshot of <code>dd</code> in 0D quantities (evaluated at <code>dd.global_time</code>).</p><p>Extract + plots saved to PDF (printed to screen if <code>filename</code> is omitted). NOTE: For PDF creation to work, one may need to install of <code>DejaVu Sans Mono</code> font.</p><pre><code class="language-julia hljs">tutorial_temp_dir = tempdir()
filename = joinpath(tutorial_temp_dir, &quot;$(ini.general.casename).pdf&quot;)
display(filename)
FUSE.digest(dd)#, filename)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GEOMETRY                                EQUILIBRIUM                             TEMPERATURES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
R0 â†’ 6.5 [m]                            B0 â†’ 7.8 [T]                            Te0 â†’ 20.7 [keV]
a â†’ 2.01 [m]                            ip â†’ 12.7 [MA]                          Ti0 â†’ 19.4 [keV]
1/Ïµ â†’ 3.24                              q95 â†’ 6.14                              &lt;Te&gt; â†’ 8.97 [keV]
Îº â†’ 2                                   &lt;Bpol&gt; â†’ 0.802 [T]                      &lt;Ti&gt; â†’ 8.1 [keV]
Î´ â†’ 0.588                               Î²pol_MHD â†’ 0.81                         Te0/&lt;Te&gt; â†’ 2.31
Î¶ â†’ -0.0136                             Î²tor_MHD â†’ 0.00882                      Ti0/&lt;Ti&gt; â†’ 2.39
Volume â†’ 930 [mÂ³]                       Î²n_MHD â†’ 1.08
Surface â†’ 759 [mÂ²]

DENSITIES                               PRESSURES                               TRANSPORT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ne0 â†’ 9.36e+19 [mâ»Â³]                    P0 â†’ 0.57 [MPa]                         Ï„e â†’ 2.39 [s]
ne_ped â†’ 6.8e+19 [mâ»Â³]                  &lt;P&gt; â†’ 0.214 [MPa]                       Ï„e_exp â†’ 1.84 [s]
ne_line â†’ 8.38e+19 [mâ»Â³]                P0/&lt;P&gt; â†’ 2.66                           H98y2 â†’ 0.888
&lt;ne&gt; â†’ 7.62e+19 [mâ»Â³]                   Î²n â†’ 1.09                               H98y2_exp â†’ 0.819
ne0/&lt;ne&gt; â†’ 1.23                         Î²n_th â†’ 1.09                            Hds03 â†’ 0.657
fGW â†’ 0.834                                                                     Hds03_exp â†’ 0.585
zeff_ped â†’ 2                                                                    Ï„Î±_thermalization â†’ 0.954 [s]
&lt;zeff&gt; â†’ 2                                                                      Ï„Î±_slowing_down â†’ 1.12 [s]
impurities â†’ DT Ne20 He4

SOURCES                                 EXHAUST                                 CURRENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pec â†’ 50 [MW]                           Psol â†’ 125 [MW]                         ip_bs_aux_ohm â†’ 13 [MA]
rho0_ec â†’ 0.56 [MW]                     PLH â†’ 135 [MW]                          ip_ni â†’ 6.24 [MA]
Pnbi â†’ NaN [MW]                         Bpol_omp â†’ 1.12 [T]                     ip_bs â†’ 3.22 [MA]
Enbi1 â†’ NaN [MeV]                       Î»q â†’ 0.972 [mm]                         ip_aux â†’ 3.01 [MA]
Pic â†’ 50 [MW]                           qpol â†’ 2.4e+03 [MW/mÂ²]                  ip_ohm â†’ 6.79 [MA]
Plh â†’ NaN [MW]                          qpar â†’ 1.31e+04 [MW/mÂ²]                 ejima â†’ 0.4
Paux_tot â†’ 100 [MW]                     P/R0 â†’ 19.2 [MW/m]                      flattop â†’ 0.7 [Hours]
PÎ± â†’ 61 [MW]                            PB/R0 â†’ 150 [MW T/m]
Pohm â†’ 0.523 [MW]                       PBp/R0 â†’ 15.4 [MW T/m]
Pheat â†’ 162 [MW]                        PBÏµ/R0q95 â†’ 7.53 [MW T/m]
Prad_tot â†’ -36.9 [MW]                   neutrons_peak â†’ 0.392 [MW/mÂ²]

BOP                                     BUILD                                   COSTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pfusion â†’ 305 [MW]                      PF_material â†’ nb3sn                     capital_cost â†’ 6.88 [$B]
Qfusion â†’ 3.05                          TF_material â†’ nb3sn_kdemo               levelized_CoE â†’ Inf [$/kWh]
thermal_cycle_type â†’ rankine            OH_material â†’ nb3sn                     TF_of_total â†’ 16.8 [%]
thermal_efficiency_plant â†’ 22.7 [%]     TF_max_b â†’ 15.4 [T]                     BOP_of_total â†’ 1.82 [%]
thermal_efficiency_cycle â†’ NaN [%]      OH_max_b â†’ 14.9 [T]                     blanket_of_total â†’ 20 [%]
power_electric_generated â†’ 19.5 [MW]    TF_j_margin â†’ 4.99                      cryostat_of_total â†’ 2.95 [%]
Pelectric_net â†’ -125 [MW]               OH_j_margin â†’ 1.4
Qplant â†’ 0.135                          TF_stress_margin â†’ 3.04
TBR â†’ 0.0747                            OH_stress_margin â†’ 1.23

@ time = 0.0 [s]
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">Â« Main</a><a class="docs-footer-nextpage" href="examples.html">Examples Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 21 September 2025 03:08">Sunday 21 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
