<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial Â· FUSE</title><meta name="title" content="Tutorial Â· FUSE"/><meta property="og:title" content="Tutorial Â· FUSE"/><meta property="twitter:title" content="Tutorial Â· FUSE"/><meta name="description" content="Documentation for FUSE."/><meta property="og:description" content="Documentation for FUSE."/><meta property="twitter:description" content="Documentation for FUSE."/><script async src="https://www.googletagmanager.com/gtag/js?id=G-65D8V8C8VQ"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-65D8V8C8VQ', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img class="docs-light-only" src="assets/logo.svg" alt="FUSE logo"/><img class="docs-dark-only" src="assets/logo-dark.svg" alt="FUSE logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Main</a></li><li><span class="tocitem">Learn</span><ul><li class="is-active"><a class="tocitem" href="tutorial.html">Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Basic-concepts"><span>Basic concepts</span></a></li><li class="toplevel"><a class="tocitem" href="#Let&#39;s-get-started!"><span>Let&#39;s get started!</span></a></li><li><a class="tocitem" href="#Starting-from-a-use-case"><span>Starting from a use-case</span></a></li><li><a class="tocitem" href="#Exploring-the-data-dictionary"><span>Exploring the data dictionary</span></a></li><li><a class="tocitem" href="#Plotting-data-from-dd"><span>Plotting data from <code>dd</code></span></a></li><li><a class="tocitem" href="#Working-with-time-series"><span>Working with time series</span></a></li><li><a class="tocitem" href="#Expressions-in-dd"><span>Expressions in <code>dd</code></span></a></li><li><a class="tocitem" href="#Whole-facility-design"><span>Whole facility design</span></a></li><li><a class="tocitem" href="#Running-a-custom-workflow"><span>Running a custom workflow</span></a></li><li><a class="tocitem" href="#Saving-and-loading-data"><span>Saving and loading data</span></a></li><li><a class="tocitem" href="#Comparing-two-IDSs"><span>Comparing two IDSs</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="pubs.html">Publications</a></li></ul></li><li><a class="tocitem" href="cases.html">Use Cases</a></li><li><span class="tocitem">Actors</span><ul><li><a class="tocitem" href="actors.html">List of actors</a></li><li><a class="tocitem" href="act.html">act parameters</a></li></ul></li><li><span class="tocitem">Initialization</span><ul><li><a class="tocitem" href="inits.html">Init routines</a></li><li><a class="tocitem" href="ini.html">ini parameters</a></li></ul></li><li><a class="tocitem" href="dd.html">Data Structure</a></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="deps.html">Ecosystem</a></li><li><a class="tocitem" href="develop.html">Contributing</a></li></ul></li><li><span class="tocitem">Install</span><ul><li><a class="tocitem" href="install.html">Install FUSE</a></li><li><a class="tocitem" href="install_saga.html">on SAGA</a></li><li><a class="tocitem" href="install_omega.html">on OMEGA</a></li></ul></li><li><span class="tocitem">License</span><ul><li><a class="tocitem" href="license.html">License</a></li><li><a class="tocitem" href="notice.html">Notice</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Learn</a></li><li class="is-active"><a href="tutorial.html">Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tutorial.html">Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ProjectTorreyPines/FUSE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ProjectTorreyPines/FUSE.jl/blob/master/docs/src/tutorial.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="FUSE-Introductory-Tutorial"><a class="docs-heading-anchor" href="#FUSE-Introductory-Tutorial">FUSE Introductory Tutorial</a><a id="FUSE-Introductory-Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#FUSE-Introductory-Tutorial" title="Permalink"></a></h1><p>Download this tutorial from the <a href="https://github.com/ProjectTorreyPines/FuseExamples/blob/master/tutorial.ipynb">FuseExamples repository</a></p><h2 id="Basic-concepts"><a class="docs-heading-anchor" href="#Basic-concepts">Basic concepts</a><a id="Basic-concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-concepts" title="Permalink"></a></h2><p>To make sense of this tutorial, you&#39;ll need to know the following organization concepts of FUSE:</p><ol><li><strong>ğŸ“‚ Data storage</strong>: All data is stored in the <code>dd</code> structure, which follows the ITER IMAS ontology.</li><li><strong>ğŸ§  Actors</strong>: The core components of FUSE simulations are physics and engineering actors.</li><li><strong>ğŸ•¹ï¸ Control</strong>: Actor functionality is governed by <code>act</code> parameters.</li><li><strong>ğŸš€ Initialization</strong>: The data structure can be initialized from 0D <code>ini</code> parameters.</li><li><strong>ğŸ”§ Use cases</strong>: FUSE includes templates for various machines (e.g., FPP, ITER, ARC).</li><li><strong>ğŸ”„ Workflows</strong>: Self-contained studies and optimizations are conducted via workflows, typically involving multiple FUSE simulations.</li><li><strong>ğŸŒ Interoperability</strong>: FUSE interfaces with existing modeling tools like OMFIT/OMAS and the IMAS ecosystem.</li></ol><p>A diagram illustrating these concepts is provided below: <img src="attachment:5ff4862c-b856-485b-9649-02fec5bdd0d7.png" alt="image.png"/></p><h1 id="Let&#39;s-get-started!"><a class="docs-heading-anchor" href="#Let&#39;s-get-started!">Let&#39;s get started!</a><a id="Let&#39;s-get-started!-1"></a><a class="docs-heading-anchor-permalink" href="#Let&#39;s-get-started!" title="Permalink"></a></h1><hr/><p><strong>NOTE</strong>: Julia is a Just In Time (JIT) programming language. The first time something is executed it will take longer because of the compilation process. Subsequent calls the the same code will be blazingly fast.</p><hr/><p>Import the necessary packages</p><pre><code class="language-julia hljs">using Plots # for plotting
using FUSE # this will also import IMAS in the current namespace</code></pre><h2 id="Starting-from-a-use-case"><a class="docs-heading-anchor" href="#Starting-from-a-use-case">Starting from a use-case</a><a id="Starting-from-a-use-case-1"></a><a class="docs-heading-anchor-permalink" href="#Starting-from-a-use-case" title="Permalink"></a></h2><p>FUSE comes with some predefined <a href="https://fuse.help/stable/cases.html">use-cases</a>, some of which are used for regression testing.</p><p>Note that some use cases are for non-nuclear experiments and certain Actors like Blankets or BalanceOfPlant will not perform any actions.</p><pre><code class="language- hljs">FUSE.test_cases</code></pre><p>Get initial parameters (<code>ini</code>) and actions (<code>act</code>) for a given use-case</p><pre><code class="language-julia hljs">ini, act = FUSE.case_parameters(:KDEMO);</code></pre><p>Modifying <a href="https://fuse.help/stable/ini.html"><code>ini</code> parameters</a>.</p><pre><code class="language-julia hljs">ini.equilibrium.B0 = 7.8
ini.equilibrium.R0 = 6.5;</code></pre><p>Modifying <a href="https://fuse.help/stable/act.html"><code>act</code> parameters</a>.</p><pre><code class="language-julia hljs">act.ActorCoreTransport.model = :FluxMatcher;</code></pre><p>Initialize the data dictionary (<code>dd</code>) using the 0D parameters.</p><p><strong>NOTE:</strong> <code>init()</code> does not return a self-consistent solution, just a plausible starting point to initialize our simulations!</p><pre><code class="language-julia hljs">dd = IMAS.dd() # an empty dd
FUSE.init(dd, ini, act);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: Equilibrium
actors:  TEQUILA
actors: CXbuild
actors: HCD
actors:  SimpleEC
actors:  SimpleIC
actors:  NeutralFueling
actors: Current
actors:  QED
actors: PassiveStructures</code></pre><p>We can <code>@checkin</code> and <code>@checkout</code> variables with an associated tag.</p><p>This is handy to save and restore our progress (we&#39;ll use this later).</p><pre><code class="language-julia hljs">@checkin :init dd ini act</code></pre><h2 id="Exploring-the-data-dictionary"><a class="docs-heading-anchor" href="#Exploring-the-data-dictionary">Exploring the data dictionary</a><a id="Exploring-the-data-dictionary-1"></a><a class="docs-heading-anchor-permalink" href="#Exploring-the-data-dictionary" title="Permalink"></a></h2><ul><li>FUSE stores data following the IMAS data schema.</li><li>The root of the data structure is <code>dd</code>, which stands for &quot;Data Dictionary&quot;.</li><li>More details are available in the <a href="https://fuse.help/stable/dd.html">documentation</a>.</li></ul><p>Display part of the equilibrium data in <code>dd</code></p><pre><code class="language-julia hljs">dd.equilibrium.time_slice[1].boundary</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">boundary</span>
â”œâ”€ elongation<span class="sgr31"> â¡ 1.999</span>
â”œâ”€ elongation_lower<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ elongation_upper<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ <span class="sgr1">geometric_axis</span>
â”‚  â”œâ”€ r<span class="sgr31"> â¡ 6.49997<span class="sgr1"> [m]</span></span>
â”‚  â””â”€ z<span class="sgr31"> â¡ 0.0133353<span class="sgr1"> [m]</span></span>
â”œâ”€ minor_radius<span class="sgr31"> â¡ 2.00734<span class="sgr1"> [m]</span></span>
â”œâ”€ <span class="sgr1">outline</span>
â”‚  â”œâ”€ r<span class="sgr31"> â¡ </span><span class="sgr32">239-element Vector{Float64}<span class="sgr1"> [m]</span></span>
â”‚  â”‚      <span class="sgr32"><span class="sgr1">min:</span></span>4.52   <span class="sgr32"><span class="sgr1">avg:</span></span>6.27   <span class="sgr32"><span class="sgr1">max:</span></span>8.49
â”‚  â””â”€ z<span class="sgr31"> â¡ </span><span class="sgr32">239-element Vector{Float64}<span class="sgr1"> [m]</span></span>
â”‚         <span class="sgr32"><span class="sgr1">min:</span></span>-4.03   <span class="sgr32"><span class="sgr1">avg:</span></span>-0.0546   <span class="sgr32"><span class="sgr1">max:</span></span>3.89
â”œâ”€ ovality<span class="sgr31"> â¡ 0.00572603</span>
â”œâ”€ squareness<span class="sgr31"> â¡ -0.0135544</span>
â”œâ”€ squareness_lower_inner<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ squareness_lower_outer<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ squareness_upper_inner<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ squareness_upper_outer<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ <span class="sgr1">strike_point</span>
â”‚  â”œâ”€ <span class="sgr1">1</span>
â”‚  â”‚  â”œâ”€ last_closed_flux_surface_gap<span class="sgr31"> â¡ 5.21493e-09<span class="sgr1"> [m]</span></span>
â”‚  â”‚  â”œâ”€ r<span class="sgr31"> â¡ 4.22041<span class="sgr1"> [m]</span></span>
â”‚  â”‚  â””â”€ z<span class="sgr31"> â¡ -4.46244<span class="sgr1"> [m]</span></span>
â”‚  â””â”€ <span class="sgr1">2</span>
â”‚     â”œâ”€ last_closed_flux_surface_gap<span class="sgr31"> â¡ 5.21493e-09<span class="sgr1"> [m]</span></span>
â”‚     â”œâ”€ r<span class="sgr31"> â¡ 5.55866<span class="sgr1"> [m]</span></span>
â”‚     â””â”€ z<span class="sgr31"> â¡ -5.07365<span class="sgr1"> [m]</span></span>
â”œâ”€ tilt<span class="sgr31"> â¡ -0.00162958</span>
â”œâ”€ triangularity<span class="sgr31"> â¡ 0.587596</span>
â”œâ”€ triangularity_lower<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ triangularity_upper<span class="sgr31"> â¡ </span><span class="sgr34">Function</span>
â”œâ”€ twist<span class="sgr31"> â¡ 0.00165424</span>
â””â”€ <span class="sgr1">x_point</span>
   â”œâ”€ <span class="sgr1">1</span>
   â”‚  â”œâ”€ r<span class="sgr31"> â¡ 5.1059<span class="sgr1"> [m]</span></span>
   â”‚  â””â”€ z<span class="sgr31"> â¡ -4.04663<span class="sgr1"> [m]</span></span>
   â””â”€ <span class="sgr1">2</span>
      â”œâ”€ r<span class="sgr31"> â¡ 4.86688<span class="sgr1"> [m]</span></span>
      â””â”€ z<span class="sgr31"> â¡ 4.35316<span class="sgr1"> [m]</span></span>
</code></pre><p>this can be done up to a certain depth with <code>print_tree</code></p><pre><code class="language-julia hljs">print_tree(dd.equilibrium.time_slice[1].boundary; maxdepth=1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">boundary
â”œâ”€ elongation â¡ 1.999
â”œâ”€ elongation_lower â¡ Function
â”œâ”€ elongation_upper â¡ Function
â”œâ”€ geometric_axis
â”‚  â‹®
â”‚
â”œâ”€ minor_radius â¡ 2.00734 [m]
â”œâ”€ outline
â”‚  â‹®
â”‚
â”œâ”€ ovality â¡ 0.00572603
â”œâ”€ squareness â¡ -0.0135544
â”œâ”€ squareness_lower_inner â¡ Function
â”œâ”€ squareness_lower_outer â¡ Function
â”œâ”€ squareness_upper_inner â¡ Function
â”œâ”€ squareness_upper_outer â¡ Function
â”œâ”€ strike_point
â”‚  â‹®
â”‚
â”œâ”€ tilt â¡ -0.00162958
â”œâ”€ triangularity â¡ 0.587596
â”œâ”€ triangularity_lower â¡ Function
â”œâ”€ triangularity_upper â¡ Function
â”œâ”€ twist â¡ 0.00165424
â””â”€ x_point
   â‹®</code></pre><h2 id="Plotting-data-from-dd"><a class="docs-heading-anchor" href="#Plotting-data-from-dd">Plotting data from <code>dd</code></a><a id="Plotting-data-from-dd-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-data-from-dd" title="Permalink"></a></h2><p>FUSE uses <code>Plots.jl</code> recipes for visualizing data from <code>dd</code>.</p><p>This allows different plots to be shown when calling <code>plot()</code> on different items in the data structure.</p><p>Learn more about Plots.jl <a href="https://docs.juliaplots.org">here</a></p><p>For example plotting the equilibrium...</p><pre><code class="language-julia hljs">plot(dd.equilibrium)</code></pre><img src="tutorial-ffed1453.svg" alt="Example block output"/><p>...or the core profiles</p><pre><code class="language-julia hljs">plot(dd.core_profiles)</code></pre><img src="tutorial-81b8c7a9.svg" alt="Example block output"/><p>Whant to know what arguments can be passed? use <code>help_plot()</code> function</p><pre><code class="language-julia hljs">help_plot(dd.equilibrium; core_profiles_overlay=true, levels_in=21, levels_out=5, show_secondary_separatrix=true, coordinate=:rho_tor_norm)</code></pre><img src="tutorial-aca08cb0.svg" alt="Example block output"/><p>These plots can be composed by calling <code>plot!()</code> instead of <code>plot()</code></p><pre><code class="language-julia hljs">plot(dd.equilibrium; color=:gray, cx=true)
plot!(dd.build.layer)
plot!(dd.pf_active)
plot!(dd.pf_passive)
plot!(dd.pulse_schedule.position_control; color=:red)</code></pre><img src="tutorial-340f09c4.svg" alt="Example block output"/><p>Plotting an array...</p><pre><code class="language-julia hljs">plot(dd.core_profiles.profiles_1d[1].pressure_thermal)</code></pre><img src="tutorial-0c5aaded.svg" alt="Example block output"/><p>...is different from plotting a field from the IDS (which plots the quantity against its coordinate and with units)</p><pre><code class="language-julia hljs">plot(dd.core_profiles.profiles_1d[1], :pressure_thermal)</code></pre><img src="tutorial-225d47df.svg" alt="Example block output"/><p>Customizing plot attributes:</p><pre><code class="language-julia hljs">plot(dd.core_profiles.profiles_1d[1], :pressure_thermal; label=&quot;&quot;, linewidth=2, color=:red, labelfontsize=25)</code></pre><img src="tutorial-800f8359.svg" alt="Example block output"/><p>Use <code>findall(ids, r&quot;...&quot;)</code> to search for certain fields. In Julia, string starting with <code>r</code> are regular expressions.</p><pre><code class="language-julia hljs">findall(dd, r&quot;\.psi&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[1] <span class="sgr31">dd</span>.core_profiles.profiles_1d[1].grid.<span class="sgr32"><span class="sgr1">psi</span></span><span class="sgr1"><span class="sgr34"> [Wb]</span></span> [101-element Vector{Float64}] (<span class="sgr34">min:</span>-63.7, <span class="sgr34">avg:</span>-37.9, <span class="sgr34">max:</span>-0.943)
[2] <span class="sgr31">dd</span>.equilibrium.time_slice[1].global_quantities.<span class="sgr32"><span class="sgr1">psi_boundary</span></span><span class="sgr1"><span class="sgr34"> [Wb]</span></span> [Float64] (<span class="sgr34">all:</span>-0.943)
[3] <span class="sgr31">dd</span>.equilibrium.time_slice[1].global_quantities.<span class="sgr32"><span class="sgr1">psi_axis</span></span><span class="sgr1"><span class="sgr34"> [Wb]</span></span> [Float64] (<span class="sgr34">all:</span>-63.7)
[4] <span class="sgr31">dd</span>.equilibrium.time_slice[1].profiles_1d.<span class="sgr32"><span class="sgr1">psi_norm</span></span> [129-element Vector{Float64}] (<span class="sgr34">min:</span>0, <span class="sgr34">avg:</span>0.5, <span class="sgr34">max:</span>1)
[5] <span class="sgr31">dd</span>.equilibrium.time_slice[1].profiles_1d.<span class="sgr32"><span class="sgr1">psi</span></span><span class="sgr1"><span class="sgr34"> [Wb]</span></span> [129-element Vector{Float64}] (<span class="sgr34">min:</span>-63.7, <span class="sgr34">avg:</span>-32.3, <span class="sgr34">max:</span>-0.943)
[6] <span class="sgr31">dd</span>.equilibrium.time_slice[1].profiles_2d[1].<span class="sgr32"><span class="sgr1">psi</span></span><span class="sgr1"><span class="sgr34"> [Wb]</span></span> [31Ã—13 Matrix{Float64}] (<span class="sgr34">min:</span>-0.0395, <span class="sgr34">avg:</span>0.657, <span class="sgr34">max:</span>6.67)
[7] <span class="sgr31">dd</span>.equilibrium.time_slice[1].profiles_2d[2].<span class="sgr32"><span class="sgr1">psi</span></span><span class="sgr1"><span class="sgr34"> [Wb]</span></span> [66Ã—129 Matrix{Float64}] (<span class="sgr34">min:</span>-63.7, <span class="sgr34">avg:</span>13.7, <span class="sgr34">max:</span>94.9)
</code></pre><p><code>findall(ids, r&quot;...&quot;)</code> can be combined with <code>plot()</code> to plot multiple fields</p><pre><code class="language-julia hljs">plot(findall(dd, r&quot;\.psi&quot;))</code></pre><img src="tutorial-afeb8f52.svg" alt="Example block output"/><h2 id="Working-with-time-series"><a class="docs-heading-anchor" href="#Working-with-time-series">Working with time series</a><a id="Working-with-time-series-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-time-series" title="Permalink"></a></h2><p>The IMAS data structure supports time-dependent data, and IMAS.jl provides ways to handle time data efficiently.</p><p>Each <code>dd</code> has a <code>global_time</code> attribute, which is used throughout FUSE and IMAS to indicate the time at which things should be operate.</p><pre><code class="language-julia hljs">dd.global_time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>For the sake of demonstrating handling of time, let&#39;s add a new time_slice to the equilibrium.</p><p>NOTE: time dependent arrays of structures can be resized with <code>resize!(ids, time0::Float64)</code> in addition to the usual <code>resize!(ids, n::Int)</code>.</p><p>resize the time dependent array of structure</p><pre><code class="language-julia hljs">resize!(dd.equilibrium.time_slice, 1.0);</code></pre><p>let&#39;s just populate it with the data from the previous time slice</p><pre><code class="language-julia hljs">dd.equilibrium.time_slice[2] = deepcopy(dd.equilibrium.time_slice[1]);
dd.equilibrium.time_slice[2].time = 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>Here we see that equilibrium has mulitiple time_slices</p><pre><code class="language-julia hljs">dd.equilibrium.time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.0
 1.0</code></pre><p>We can access time-dependent arrays of structures via integer index...</p><pre><code class="language-julia hljs">eqt = dd.equilibrium.time_slice[2]
eqt.time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>...or at a given time, by passing the time as a floating point number (in seconds)</p><pre><code class="language-julia hljs">eqt = dd.equilibrium.time_slice[1.0]
eqt.time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>NOTE: If we ask a time that is not exactly in the arrays of structures, we&#39;ll get the closest (causal!) time-slice</p><pre><code class="language-julia hljs">eqt = dd.equilibrium.time_slice[0.9]
eqt.time

eqt = dd.equilibrium.time_slice[1.1]
eqt.time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>... or at the current <code>dd.global_time</code> by leaving the square brackets empty []</p><p>NOTE: <strong>This is what you want to use in most situations that involve arrays of structures!</strong></p><pre><code class="language-julia hljs">dd.global_time = 0.0
eqt = dd.equilibrium.time_slice[]
eqt.time

dd.global_time = 1.0
eqt = dd.equilibrium.time_slice[]
eqt.time</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><p>What we described above was for time-dependent arrays of structures.</p><p>The other place where time comes in, is when dealing with time-dependent arrays of data.</p><p>In this case, we can use the <code>@ddtime</code> macro to manipulate these time-dependent arrays at <code>dd.global_time</code>.</p><p>NOTE: Also in this case, <code>@ddtime</code> will operate on the closest (causal!) time point</p><pre><code class="language-julia hljs">dd.equilibrium.vacuum_toroidal_field.b0

dd.global_time = 1.0
@ddtime(dd.equilibrium.vacuum_toroidal_field.b0 = 10.0)
dd.equilibrium.vacuum_toroidal_field.b0

dd.global_time = 0.0
@ddtime(dd.equilibrium.vacuum_toroidal_field.b0)

dd.global_time = 1.0
@ddtime(dd.equilibrium.vacuum_toroidal_field.b0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10.0</code></pre><h2 id="Expressions-in-dd"><a class="docs-heading-anchor" href="#Expressions-in-dd">Expressions in <code>dd</code></a><a id="Expressions-in-dd-1"></a><a class="docs-heading-anchor-permalink" href="#Expressions-in-dd" title="Permalink"></a></h2><p>Some fields in the data dictionary are expressions (ie. Functions). For example <code>dd.core_profiles.profiles_1d[].pressure</code> is dynamically calculated as the product of thermal densities and temperature with addition of fast ions contributions</p><pre><code class="language-julia hljs">dd.global_time = 0.0
print_tree(dd.core_profiles.profiles_1d[]; maxdepth=1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1
â”œâ”€ conductivity_parallel â¡ Function [ohm^-1.m^-1]
â”œâ”€ electrons
â”‚  â‹®
â”‚
â”œâ”€ grid
â”‚  â‹®
â”‚
â”œâ”€ ion
â”‚  â‹®
â”‚
â”œâ”€ j_bootstrap â¡ 101-element Vector{Float64} [A/m^2]
â”‚                min:3.16e+03   avg:1.4e+05   max:1.87e+05
â”œâ”€ j_non_inductive â¡ 101-element Vector{Float64} [A/m^2]
â”‚                    min:3.16e+03   avg:9.3e+05   max:5.7e+06
â”œâ”€ j_ohmic â¡ 101-element Vector{Float64} [A/m^2]
â”‚            min:549   avg:4.47e+05   max:1.51e+06
â”œâ”€ j_tor â¡ 101-element Vector{Float64} [A/m^2]
â”‚          min:3.15e+03   avg:1.39e+06   max:7.3e+06
â”œâ”€ j_total â¡ 101-element Vector{Float64} [A/m^2]
â”‚            min:3.71e+03   avg:1.38e+06   max:7.17e+06
â”œâ”€ neutral
â”‚  â‹®
â”‚
â”œâ”€ pressure â¡ Function [Pa]
â”œâ”€ pressure_ion_total â¡ Function [Pa]
â”œâ”€ pressure_parallel â¡ Function [Pa]
â”œâ”€ pressure_perpendicular â¡ Function [Pa]
â”œâ”€ pressure_thermal â¡ Function [Pa]
â”œâ”€ rotation_frequency_tor_sonic â¡ 101-element Vector{Float64} [s^-1]
â”‚                                 all:0
â”œâ”€ t_i_average â¡ Function [eV]
â”œâ”€ time â¡ 0 [s]
â””â”€ zeff â¡ 101-element Vector{Float64}
          all:2</code></pre><p>accessing a dynamic expression, automatically evaluates it</p><pre><code class="language-julia hljs">dd.core_profiles.profiles_1d[].conductivity_parallel</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">101-element Vector{Float64}:
      2.4470860067991085e9
      2.390463400716408e9
      2.315428174422292e9
      2.237495413464632e9
      2.1586767799365816e9
      2.0795007898916874e9
      2.0002132276586096e9
      1.9209796999325612e9
      1.8651326730942469e9
      1.8122021245786593e9
      â‹®
      2.8520814947363466e7
      2.6984632262510967e7
      2.5257682356890127e7
      2.2844525710940488e7
      1.91134661916165e7
      1.3684208667101657e7
      7.7328004412034275e6
      3.0794749444928337e6
 599200.8202049042</code></pre><p>In addition to evaluating expressions by accessing them, expressions in the tree can be evaluated using <code>IMAS.freeze(ids)</code></p><p>NOTE: <code>IMAS.freeze(ids, field::Symbol)</code> works on a single field and <code>IMAS.refreeze!(ids, field)</code> forces re-evaluation of an expression. Also, <code>IMAS.empty!(ids, field::Symbol)</code> can be used to revert a frozen field back into an expression.</p><pre><code class="language-julia hljs">print_tree(IMAS.freeze(dd.core_profiles.profiles_1d[1]); maxdepth=1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">profiles_1d [DETACHED]
â”œâ”€ conductivity_parallel â¡ 101-element Vector{Float64} [ohm^-1.m^-1]
â”‚                          min:5.99e+05   avg:7.09e+08   max:2.45e+09
â”œâ”€ electrons
â”‚  â‹®
â”‚
â”œâ”€ grid
â”‚  â‹®
â”‚
â”œâ”€ ion
â”‚  â‹®
â”‚
â”œâ”€ j_bootstrap â¡ 101-element Vector{Float64} [A/m^2]
â”‚                min:3.16e+03   avg:1.4e+05   max:1.87e+05
â”œâ”€ j_non_inductive â¡ 101-element Vector{Float64} [A/m^2]
â”‚                    min:3.16e+03   avg:9.3e+05   max:5.7e+06
â”œâ”€ j_ohmic â¡ 101-element Vector{Float64} [A/m^2]
â”‚            min:549   avg:4.47e+05   max:1.51e+06
â”œâ”€ j_tor â¡ 101-element Vector{Float64} [A/m^2]
â”‚          min:3.15e+03   avg:1.39e+06   max:7.3e+06
â”œâ”€ j_total â¡ 101-element Vector{Float64} [A/m^2]
â”‚            min:3.71e+03   avg:1.38e+06   max:7.17e+06
â”œâ”€ neutral
â”‚  â‹®
â”‚
â”œâ”€ pressure â¡ 101-element Vector{Float64} [Pa]
â”‚             min:363   avg:3.72e+05   max:8.21e+05
â”œâ”€ pressure_ion_total â¡ 101-element Vector{Float64} [Pa]
â”‚                       min:171   avg:1.47e+05   max:2.99e+05
â”œâ”€ pressure_parallel â¡ 101-element Vector{Float64} [Pa]
â”‚                      min:121   avg:1.24e+05   max:2.74e+05
â”œâ”€ pressure_perpendicular â¡ 101-element Vector{Float64} [Pa]
â”‚                           min:121   avg:1.24e+05   max:2.74e+05
â”œâ”€ pressure_thermal â¡ 101-element Vector{Float64} [Pa]
â”‚                     min:363   avg:3.11e+05   max:6.34e+05
â”œâ”€ rotation_frequency_tor_sonic â¡ 101-element Vector{Float64} [s^-1]
â”‚                                 all:0
â”œâ”€ t_i_average â¡ 101-element Vector{Float64} [eV]
â”‚                min:80   avg:1.32e+04   max:2.5e+04
â”œâ”€ time â¡ 0 [s]
â””â”€ zeff â¡ 101-element Vector{Float64}
          all:2</code></pre><h2 id="Whole-facility-design"><a class="docs-heading-anchor" href="#Whole-facility-design">Whole facility design</a><a id="Whole-facility-design-1"></a><a class="docs-heading-anchor-permalink" href="#Whole-facility-design" title="Permalink"></a></h2><p>Here we restore the <code>:init</code> checkpoint that we had previously stored. Resetting any changes to <code>dd</code>, <code>ini</code>, and <code>act</code> that we did in the meantime.</p><pre><code class="language-julia hljs">@checkout :init dd ini act</code></pre><p>Actors in FUSE can be executed by passing two arguments to them: <code>dd</code> and <code>act</code>. Internally, actors can call other actors, creating workflows. For example, the <code>ActorWholeFacility</code> can be used to to get a self-consistent stationary whole facility design. The <code>actors:</code> print statements with their nested output tell us what actors are calling other actors.</p><pre><code class="language-julia hljs">FUSE.ActorWholeFacility(dd, act);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: WholeFacility
actors:  PFdesign
actors:  StationaryPlasma
actors:   --------------- 1/5
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Current
actors:    QED
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:   Current
actors:    QED
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 1/5 @ 364.92%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Current
actors:    QED
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:   Current
actors:    QED
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 2/5 @ 580.12%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Current
actors:    QED
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:   Current
actors:    QED
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 3/5 @ 370.40%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Current
actors:    QED
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:   Current
actors:    QED
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 4/5 @ 170.82%
actors:   HCD
actors:    SimpleEC
actors:    SimpleIC
actors:    NeutralFueling
actors:   Current
actors:    QED
actors:   Pedestal
actors:    EPED
actors:   CoreTransport
actors:    FluxMatcher
actors:   Current
actors:    QED
actors:   Equilibrium
actors:    TEQUILA
actors:   --------------- 5/5 @ 116.18%
â”Œ Warning: Max number of iterations (5) has been reached with convergence error of (1)[0.182, 0.29, 0.185, 0.085, 0.058](5) compared to threshold of 0.05
â”” @ FUSE ~/work/FUSE.jl/FUSE.jl/src/actors/compound/stationary_plasma_actor.jl:206
actors:  HFSsizing
actors:   FluxSwing
actors:   Stresses
actors:  LFSsizing
actors:  CXbuild
actors:  PFdesign
actors:  Equilibrium
actors:   TEQUILA
actors:  CXbuild
actors:  Neutronics
actors:  Blanket
actors:  CXbuild
actors:  PassiveStructures
actors:  Divertors
actors:  PlasmaLimits
actors:   VerticalStability
actors:   TroyonBetaNN
actors:  BalanceOfPlant
actors:   ThermalPlant
actors:   PowerNeeds
actors:  Costing
actors:   CostingARIES</code></pre><p>Let&#39;s check what we got at a glance with the <code>FUSE.digest(dd)</code> function:</p><pre><code class="language-julia hljs">FUSE.digest(dd)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GEOMETRY                                EQUILIBRIUM                             TEMPERATURES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
R0 â†’ 6.5 [m]                            B0 â†’ 7.8 [T]                            Te0 â†’ 18.1 [keV]
a â†’ 2.01 [m]                            ip â†’ 12.7 [MA]                          Ti0 â†’ 19.9 [keV]
1/Ïµ â†’ 3.24                              q95 â†’ 6.05                              &lt;Te&gt; â†’ 8.8 [keV]
Îº â†’ 2                                   &lt;Bpol&gt; â†’ 0.799 [T]                      &lt;Ti&gt; â†’ 7.98 [keV]
Î´ â†’ 0.588                               Î²pol_MHD â†’ 0.839                        Te0/&lt;Te&gt; â†’ 2.05
Î¶ â†’ -0.0136                             Î²tor_MHD â†’ 0.00918                      Ti0/&lt;Ti&gt; â†’ 2.5
Volume â†’ 928 [mÂ³]                       Î²n_MHD â†’ 1.12
Surface â†’ 755 [mÂ²]

DENSITIES                               PRESSURES                               TRANSPORT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ne0 â†’ 9.77e+19 [mâ»Â³]                    P0 â†’ 0.662 [MPa]                        Ï„e â†’ 2.38 [s]
ne_ped â†’ 6.88e+19 [mâ»Â³]                 &lt;P&gt; â†’ 0.222 [MPa]                       Ï„e_exp â†’ 1.84 [s]
ne_line â†’ 8.52e+19 [mâ»Â³]                P0/&lt;P&gt; â†’ 2.97                           H98y2 â†’ 0.88
&lt;ne&gt; â†’ 7.67e+19 [mâ»Â³]                   Î²n â†’ 1.14                               H98y2_exp â†’ 0.812
ne0/&lt;ne&gt; â†’ 1.27                         Î²n_th â†’ 1.08                            Hds03 â†’ 0.651
fGW â†’ 0.851                                                                     Hds03_exp â†’ 0.58
zeff_ped â†’ 2                                                                    Ï„Î±_thermalization â†’ 0.81 [s]
&lt;zeff&gt; â†’ 2                                                                      Ï„Î±_slowing_down â†’ 0.881 [s]
impurities â†’ DT Ne20 He4

SOURCES                                 EXHAUST                                 CURRENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pec â†’ 50 [MW]                           Psol â†’ 124 [MW]                         ip_bs_aux_ohm â†’ 13 [MA]
rho0_ec â†’ 0.56 [MW]                     PLH â†’ 135 [MW]                          ip_ni â†’ 6.13 [MA]
Pnbi â†’ NaN [MW]                         Bpol_omp â†’ 1.13 [T]                     ip_bs â†’ 3.15 [MA]
Enbi1 â†’ NaN [MeV]                       Î»q â†’ 0.961 [mm]                         ip_aux â†’ 2.99 [MA]
Pic â†’ 50 [MW]                           qpol â†’ 2.41e+03 [MW/mÂ²]                 ip_ohm â†’ 6.89 [MA]
Plh â†’ NaN [MW]                          qpar â†’ 1.3e+04 [MW/mÂ²]                  ejima â†’ 0.4
Paux_tot â†’ 100 [MW]                     P/R0 â†’ 19 [MW/m]                        flattop â†’ 0.7 [Hours]
PÎ± â†’ 59.4 [MW]                          PB/R0 â†’ 148 [MW T/m]
Pohm â†’ 0.551 [MW]                       PBp/R0 â†’ 15.2 [MW T/m]
Pheat â†’ 160 [MW]                        PBÏµ/R0q95 â†’ 7.58 [MW T/m]
Prad_tot â†’ -36.3 [MW]                   neutrons_peak â†’ 0.4 [MW/mÂ²]

BOP                                     BUILD                                   COSTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Pfusion â†’ 297 [MW]                      PF_material â†’ nb3sn                     capital_cost â†’ 7.21 [$B]
Qfusion â†’ 2.97                          TF_material â†’ nb3sn_kdemo               levelized_CoE â†’ Inf [$/kWh]
thermal_cycle_type â†’ rankine            OH_material â†’ nb3sn                     TF_of_total â†’ 16.1 [%]
thermal_efficiency_plant â†’ 22.7 [%]     TF_max_b â†’ 15.4 [T]                     BOP_of_total â†’ 1.74 [%]
thermal_efficiency_cycle â†’ NaN [%]      OH_max_b â†’ 16.2 [T]                     blanket_of_total â†’ 19.5 [%]
power_electric_generated â†’ 19.5 [MW]    TF_j_margin â†’ 6.59                      cryostat_of_total â†’ 2.84 [%]
Pelectric_net â†’ -125 [MW]               OH_j_margin â†’ 1.41
Qplant â†’ 0.135                          TF_stress_margin â†’ 3.03
TBR â†’ 0.0798                            OH_stress_margin â†’ 1.36

@ time = 0.0 [s]
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
â€‹
GKS: could not find font middle.ttf
â€‹
â€‹
â€‹</code></pre><p>Like before we can checkpoint results for later use</p><pre><code class="language-julia hljs">@checkin :awf dd ini act</code></pre><h2 id="Running-a-custom-workflow"><a class="docs-heading-anchor" href="#Running-a-custom-workflow">Running a custom workflow</a><a id="Running-a-custom-workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Running-a-custom-workflow" title="Permalink"></a></h2><p>Let&#39;s now run a series of actors similar to what <code>ActorWholeFacility</code> does and play around with plotting to get a sense of what each individual actor does.</p><p>Let&#39;s start again from after the initialization stage</p><pre><code class="language-julia hljs">@checkout :init dd ini act</code></pre><p>Let&#39;s start by positioning the PF coils, so that we stand a chance to reproduce the desired plasma shape. This will be important to ensure the stability of the <code>ActorStationaryPlasma</code> that we are going to run next.</p><pre><code class="language-julia hljs">FUSE.ActorPFdesign(dd, act; do_plot=true); # instead of setting `act.ActorPFdesign.do_plot=true` we can just pass `do_plot=true` as argument without chaning `act`</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: PFdesign</code></pre><p>The <code>ActorStationaryPlasma</code> iterates between plasma transport, pedestal, equilibrium and sources to return a self-consistent plasma solution</p><pre><code class="language-julia hljs">peq = plot(dd.equilibrium; label=&quot;before&quot;)
pcp = plot(dd.core_profiles; color=:gray, label=&quot;before&quot;)
FUSE.ActorStationaryPlasma(dd, act);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: StationaryPlasma
actors:  --------------- 1/5
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Current
actors:   QED
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:  Current
actors:   QED
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 1/5 @ 364.92%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Current
actors:   QED
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:  Current
actors:   QED
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 2/5 @ 580.12%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Current
actors:   QED
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:  Current
actors:   QED
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 3/5 @ 370.40%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Current
actors:   QED
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:  Current
actors:   QED
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 4/5 @ 170.82%
actors:  HCD
actors:   SimpleEC
actors:   SimpleIC
actors:   NeutralFueling
actors:  Current
actors:   QED
actors:  Pedestal
actors:   EPED
actors:  CoreTransport
actors:   FluxMatcher
actors:  Current
actors:   QED
actors:  Equilibrium
actors:   TEQUILA
actors:  --------------- 5/5 @ 116.18%
â”Œ Warning: Max number of iterations (5) has been reached with convergence error of (1)[0.182, 0.29, 0.185, 0.085, 0.058](5) compared to threshold of 0.05
â”” @ FUSE ~/work/FUSE.jl/FUSE.jl/src/actors/compound/stationary_plasma_actor.jl:206</code></pre><p>we can compare equilibrium before and after the self-consistency loop</p><pre><code class="language-julia hljs">plot!(peq, dd.equilibrium; label=&quot;after&quot;)</code></pre><img src="tutorial-12467c53.svg" alt="Example block output"/><p>we can compare core_profiles before and after the self-consistency loop</p><pre><code class="language-julia hljs">plot!(pcp, dd.core_profiles; label=&quot;after&quot;)</code></pre><img src="tutorial-475f4f40.svg" alt="Example block output"/><p>here are the sources</p><pre><code class="language-julia hljs">plot(dd.core_sources)</code></pre><img src="tutorial-5ed90176.svg" alt="Example block output"/><p>and the flux-matched transport</p><pre><code class="language-julia hljs">plot(dd.core_transport)</code></pre><img src="tutorial-3c493790.svg" alt="Example block output"/><p>HFS sizing actor changes the thickness of the OH and TF layers on the high field side to satisfy current and stresses constraints</p><pre><code class="language-julia hljs">plot(dd.build)
FUSE.ActorHFSsizing(dd, act);
plot!(dd.build; cx=false)</code></pre><img src="tutorial-f8e29d4a.svg" alt="Example block output"/><p>The stresses on the center stack are stored in the <code>solid_mechanics</code> IDS</p><pre><code class="language-julia hljs">plot(dd.solid_mechanics.center_stack.stress)</code></pre><img src="tutorial-232e49d0.svg" alt="Example block output"/><p>LFS sizing actors change location of the outer TF leg to meet ripple requirements</p><pre><code class="language-julia hljs">plot(dd.build)
FUSE.ActorLFSsizing(dd, act);
plot!(dd.build; cx=false)</code></pre><img src="tutorial-91547021.svg" alt="Example block output"/><p>A custom <code>show()</code> method is defined to print the summary of <code>dd.build.layer</code></p><pre><code class="language-julia hljs">dd.build.layer</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">23Ã—10 DataFrame
 Row â”‚ group   details                            type      Î”R          R_start   R_end     material      area        volume     shape
     â”‚<span class="sgr90"> String  String                             String    Float64     Float64   Float64   String        Float64     Float64    String
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ in                                                   1.27341      0.0       1.27341  steel          20.151       99.383   rectangle
   2 â”‚ in                                         oh        0.342778     1.27341   1.61619  nb3sn           6.99039     80.9118  rectangle
   3 â”‚ hfs                                        tf        1.68183      1.61619   3.29802  nb3sn_kdemo    43.1068     893.261   convex hull
   4 â”‚ hfs     gap tf vacuum vessel                         0.0          3.29802   3.29802  vacuum          7.50531    494.647   double ellipse
   5 â”‚ hfs     vacuum  outer                      vessel    0.0983016    3.29802   3.39632  steel           3.07657    125.573   negative offset
   6 â”‚ hfs     gap water                                    0.147452     3.39632   3.54377  water           4.50099    183.828   negative offset
   7 â”‚ hfs     vacuum  inner                      vessel    0.0983016    3.54377   3.64208  steel           2.92474    119.531   negative offset
   8 â”‚ hfs     gap high temp shield vacuum vessâ€¦            0.00983016   3.64208   3.65191  vacuum          0.289134    11.8201  negative offset
   9 â”‚ hfs     high temp                          shield    0.196603     3.65191   3.84851  steel           5.65514    231.326   negative offset
  10 â”‚ hfs                                        blanket   0.373546     3.84851   4.22205  lithium_lead   21.3676     976.315   negative offset
  11 â”‚ hfs     first                              wall      0.0196603    4.22205   4.24172  tungsten        1.02216     33.8526  offset
  12 â”‚ lhfs                                       plasma    4.51651      4.24172   8.75822  plasma         32.1483    1253.13
  13 â”‚ lfs     first                              wall      0.0196603    8.75822   8.77788  tungsten        1.02203     33.8512  offset
  14 â”‚ lfs                                        blanket   1.17962      8.77788   9.9575   lithium_lead   21.3677     976.316   negative offset
  15 â”‚ lfs     high temp                          shield    0.196603     9.9575   10.1541   steel           5.65514    231.326   negative offset
  16 â”‚ lfs     gap high temp shield vacuum vessâ€¦            0.044173    10.1541   10.1983   vacuum          0.289134    11.8201  negative offset
  17 â”‚ lfs     vacuum  inner                      vessel    0.0983016   10.1983   10.2966   steel           2.92474    119.531   negative offset
  18 â”‚ lfs     gap water                                    0.147452    10.2966   10.444    water           4.50099    183.828   negative offset
  19 â”‚ lfs     vacuum  outer                      vessel    0.0983016   10.444    10.5423   steel           3.07657    125.573   negative offset
  20 â”‚ lfs     gap tf vacuum vessel                         0.7756      10.5423   11.3179   vacuum          7.50531    494.647   double ellipse
  21 â”‚ lfs                                        tf        1.68183     11.3179   12.9998   nb3sn_kdemo    43.1068     893.261   convex hull
  22 â”‚ out                                                  1.96603      0.0      14.9658   vacuum        164.962     8444.88
  23 â”‚ out                                        cryostat  0.0983016    0.0      15.0641   steel           4.88694    311.924   silo</span></span></code></pre><p>ActorHFSsizing and ActorLFSsizing only change the layer&#39;s thicknesses, so we then need to trigger a build of the 2D cross-sections after them:</p><pre><code class="language-julia hljs">FUSE.ActorCXbuild(dd, act);
plot(dd.build)</code></pre><img src="tutorial-999e24f3.svg" alt="Example block output"/><p>Generate passive structures information (for now the vacuum vessel)</p><pre><code class="language-julia hljs">FUSE.ActorPassiveStructures(dd, act)
plot(dd.pf_passive)</code></pre><img src="tutorial-5cd32708.svg" alt="Example block output"/><p>We can now give the PF coils their final position given the new build</p><pre><code class="language-julia hljs">actor = FUSE.ActorPFdesign(dd, act);
plot(actor) # some actors define their own plot</code></pre><img src="tutorial-87f209bd.svg" alt="Example block output"/><p>With information about both pf<em>active and pf</em>passive we can now evaluate vertical stability</p><pre><code class="language-julia hljs">FUSE.ActorVerticalStability(dd, act)
IMAS.freeze(dd.mhd_linear)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">mhd_linear [DETACHED]</span>
â”œâ”€ time<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [s]</span></span>
â””â”€ <span class="sgr1">time_slice</span>
   â””â”€ <span class="sgr1">1</span>
      â”œâ”€ time<span class="sgr31"> â¡ 0<span class="sgr1"> [s]</span></span>
      â””â”€ <span class="sgr1">toroidal_mode</span>
         â”œâ”€ <span class="sgr1">1</span>
         â”‚  â”œâ”€ n_tor<span class="sgr31"> â¡ </span><span class="sgr33">0</span>
         â”‚  â”œâ”€ <span class="sgr1">perturbation_type</span>
         â”‚  â”‚  â”œâ”€ description<span class="sgr31"> â¡ </span><span class="sgr35">&quot;Vertical stability margin &gt; 0.15 for stability&quot;</span>
         â”‚  â”‚  â””â”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;m_s&quot;</span>
         â”‚  â””â”€ stability_metric<span class="sgr31"> â¡ 0.179744</span>
         â””â”€ <span class="sgr1">2</span>
            â”œâ”€ n_tor<span class="sgr31"> â¡ </span><span class="sgr33">0</span>
            â”œâ”€ <span class="sgr1">perturbation_type</span>
            â”‚  â”œâ”€ description<span class="sgr31"> â¡ </span><span class="sgr35">&quot;Normalized vertical growth rate &lt; 10 for stability&quot;</span>
            â”‚  â””â”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;Î³Ï„&quot;</span>
            â””â”€ stability_metric<span class="sgr31"> â¡ 6.68458</span>
</code></pre><p>The <code>ActorNeutronics</code> calculates the heat flux on the first wall</p><pre><code class="language-julia hljs">FUSE.ActorNeutronics(dd, act);
p = plot(; layout=2, size=(900, 350))
plot!(p, dd.neutronics.time_slice[].wall_loading, subplot=1)
plot!(p, FUSE.define_neutrons(dd, 100000)[1], dd.equilibrium.time_slice[]; subplot=1, colorbar_entry=false)
plot!(p, dd.neutronics.time_slice[].wall_loading; cx=false, subplot=2, ylabel=&quot;&quot;)</code></pre><img src="tutorial-abb2905e.svg" alt="Example block output"/><p>The <code>ActorBlanket</code> will change the thickess of the first wall, breeder, shield, and Li6 enrichment to achieve target TBR</p><pre><code class="language-julia hljs">FUSE.ActorBlanket(dd, act);
print_tree(IMAS.freeze(dd.blanket); maxdepth=5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: Blanket
blanket [DETACHED]
â”œâ”€ module
â”‚  â””â”€ 1
â”‚     â”œâ”€ layer
â”‚     â”‚  â”œâ”€ 1
â”‚     â”‚  â”‚  â”œâ”€ material â¡ &quot;tungsten&quot;
â”‚     â”‚  â”‚  â”œâ”€ midplane_thickness â¡ 0.019956 [m]
â”‚     â”‚  â”‚  â””â”€ name â¡ &quot;lfs first wall&quot;
â”‚     â”‚  â”œâ”€ 2
â”‚     â”‚  â”‚  â”œâ”€ material â¡ &quot;lithium-lead: Li6/7=90.000%&quot;
â”‚     â”‚  â”‚  â”œâ”€ midplane_thickness â¡ 1.28822 [m]
â”‚     â”‚  â”‚  â””â”€ name â¡ &quot;lfs blanket&quot;
â”‚     â”‚  â””â”€ 3
â”‚     â”‚     â”œâ”€ material â¡ &quot;steel&quot;
â”‚     â”‚     â”œâ”€ midplane_thickness â¡ 0.08771 [m]
â”‚     â”‚     â””â”€ name â¡ &quot;lfs high temp shield&quot;
â”‚     â”œâ”€ name â¡ &quot;blanket&quot;
â”‚     â””â”€ time_slice
â”‚        â””â”€ 1
â”‚           â”œâ”€ peak_escape_flux â¡ 213624 [W/m^2]
â”‚           â”œâ”€ peak_wall_flux â¡ 990624 [W/m^2]
â”‚           â”œâ”€ power_incident_neutrons â¡ 1.04377e+07 [W]
â”‚           â”œâ”€ power_incident_radiated â¡ 0 [W]
â”‚           â”œâ”€ power_thermal_extracted â¡ 1.25252e+07 [W]
â”‚           â”œâ”€ power_thermal_neutrons â¡ 1.25252e+07 [W]
â”‚           â”œâ”€ power_thermal_radiated â¡ 0 [W]
â”‚           â”œâ”€ time â¡ 0 [s]
â”‚           â””â”€ tritium_breeding_ratio â¡ 1.66648
â”œâ”€ time â¡ [0] [s]
â””â”€ tritium_breeding_ratio â¡ [0.0731709]</code></pre><p>The <code>ActorDivertors</code> actor calculates the divertors heat flux</p><pre><code class="language-julia hljs">FUSE.ActorDivertors(dd, act);
print_tree(IMAS.freeze(dd.divertors); maxdepth=4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">actors: Divertors
divertors [DETACHED]
â”œâ”€ divertor
â”‚  â””â”€ 1
â”‚     â”œâ”€ power_black_body
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_conducted
â”‚     â”‚  â”œâ”€ data â¡ [1.2367e+08] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_convected
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_currents
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_incident
â”‚     â”‚  â”œâ”€ data â¡ [3.65639e+07] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_neutrals
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_radiated
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_recombination_neutrals
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_recombination_plasma
â”‚     â”‚  â”œâ”€ data â¡ [0] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â”œâ”€ power_thermal_extracted
â”‚     â”‚  â”œâ”€ data â¡ [3.65639e+07] [W]
â”‚     â”‚  â””â”€ time â¡ [0] [s]
â”‚     â””â”€ target
â”‚        â”œâ”€ 1
â”‚        â”‚  â‹®
â”‚        â”‚
â”‚        â””â”€ 2
â”‚           â‹®
â”‚
â””â”€ time â¡ [0] [s]</code></pre><p>The <code>ActorBalanceOfPlant</code> calculates the optimal cooling flow rates for the heat sources (breeder, divertor, and wall) and get an efficiency for the electricity conversion cycle</p><pre><code class="language-julia hljs">FUSE.ActorBalanceOfPlant(dd, act);
IMAS.freeze(dd.balance_of_plant)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">balance_of_plant [DETACHED]</span>
â”œâ”€ Q_plant<span class="sgr31"> â¡ </span><span class="sgr32">[0.133698]</span>
â”œâ”€ power_electric_net<span class="sgr31"> â¡ </span><span class="sgr32">[-1.25614e+08]<span class="sgr1"> [W]</span></span>
â”œâ”€ <span class="sgr1">power_electric_plant_operation</span>
â”‚  â”œâ”€ <span class="sgr1">system</span>
â”‚  â”‚  â”œâ”€ <span class="sgr1">1</span>
â”‚  â”‚  â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">1</span>
â”‚  â”‚  â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;HCD&quot;</span>
â”‚  â”‚  â”‚  â”œâ”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[1e+08]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚  â””â”€ <span class="sgr1">subsystem</span>
â”‚  â”‚  â”‚     â”œâ”€ <span class="sgr1">1</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">1</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;nbi&quot;</span>
â”‚  â”‚  â”‚     â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚     â”œâ”€ <span class="sgr1">2</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">2</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;ec_launchers&quot;</span>
â”‚  â”‚  â”‚     â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[5e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚     â”œâ”€ <span class="sgr1">3</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">3</span>
â”‚  â”‚  â”‚     â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;ic_antennas&quot;</span>
â”‚  â”‚  â”‚     â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[5e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”‚     â””â”€ <span class="sgr1">4</span>
â”‚  â”‚  â”‚        â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">4</span>
â”‚  â”‚  â”‚        â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;lh_antennas&quot;</span>
â”‚  â”‚  â”‚        â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”œâ”€ <span class="sgr1">2</span>
â”‚  â”‚  â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">3</span>
â”‚  â”‚  â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;cryostat&quot;</span>
â”‚  â”‚  â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[3e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”œâ”€ <span class="sgr1">3</span>
â”‚  â”‚  â”‚  â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">4</span>
â”‚  â”‚  â”‚  â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;tritium_handling&quot;</span>
â”‚  â”‚  â”‚  â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[1.5e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â””â”€ <span class="sgr1">4</span>
â”‚  â”‚     â”œâ”€ index<span class="sgr31"> â¡ </span><span class="sgr33">6</span>
â”‚  â”‚     â”œâ”€ name<span class="sgr31"> â¡ </span><span class="sgr35">&quot;pf_active&quot;</span>
â”‚  â”‚     â””â”€ power<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [W]</span></span>
â”‚  â””â”€ total_power<span class="sgr31"> â¡ </span><span class="sgr32">[1.45e+08]<span class="sgr1"> [W]</span></span>
â”œâ”€ <span class="sgr1">power_plant</span>
â”‚  â”œâ”€ <span class="sgr1">heat_load</span>
â”‚  â”‚  â”œâ”€ breeder<span class="sgr31"> â¡ </span><span class="sgr32">[1.25252e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â”œâ”€ divertor<span class="sgr31"> â¡ </span><span class="sgr32">[3.65639e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”‚  â””â”€ wall<span class="sgr31"> â¡ </span><span class="sgr32">[3.63095e+07]<span class="sgr1"> [W]</span></span>
â”‚  â”œâ”€ power_cycle_type<span class="sgr31"> â¡ </span><span class="sgr35">&quot;rankine&quot;</span>
â”‚  â”œâ”€ power_electric_generated<span class="sgr31"> â¡ </span><span class="sgr32">[1.93862e+07]<span class="sgr1"> [W]</span></span>
â”‚  â””â”€ total_heat_supplied<span class="sgr31"> â¡ </span><span class="sgr32">[8.53986e+07]<span class="sgr1"> [W]</span></span>
â”œâ”€ thermal_efficiency_plant<span class="sgr31"> â¡ </span><span class="sgr32">[0.227008]</span>
â””â”€ time<span class="sgr31"> â¡ </span><span class="sgr32">[0]<span class="sgr1"> [s]</span></span>
</code></pre><p><code>ActorCosting</code> will break down the capital and operational costs</p><pre><code class="language-julia hljs">FUSE.ActorCosting(dd, act)
plot(dd.costing)</code></pre><img src="tutorial-1bebadfb.svg" alt="Example block output"/><p>Let&#39;s checkpoint our results</p><pre><code class="language-julia hljs">@checkin :manual dd ini act</code></pre><h2 id="Saving-and-loading-data"><a class="docs-heading-anchor" href="#Saving-and-loading-data">Saving and loading data</a><a id="Saving-and-loading-data-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-and-loading-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">tutorial_temp_dir = tempdir()
filename = joinpath(tutorial_temp_dir, &quot;$(ini.general.casename).json&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/tmp/K-DEMO.json&quot;</code></pre><p>When saving data to be shared outside of FUSE, one can set <code>freeze=true</code> so that all expressions in the dd are evaluated and saved to file.</p><pre><code class="language-julia hljs">IMAS.imas2json(dd, filename; freeze=false, strict=false);</code></pre><p>Load from JSON</p><pre><code class="language-julia hljs">dd1 = IMAS.json2imas(filename);</code></pre><h2 id="Comparing-two-IDSs"><a class="docs-heading-anchor" href="#Comparing-two-IDSs">Comparing two IDSs</a><a id="Comparing-two-IDSs-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-two-IDSs" title="Permalink"></a></h2><p>We can introduce a change in the <code>dd1</code> and spot it with the <code>diff</code> function</p><pre><code class="language-julia hljs">dd1.equilibrium.time_slice[1].time = -100.0
IMAS.diff(dd.equilibrium, dd1.equilibrium)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{String, String} with 1 entry:
  &quot;time_slice[1].time&quot; =&gt; &quot;value:  0.0 --  -100.0&quot;</code></pre><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>Snapshot of <code>dd</code> in 0D quantities (evaluated at <code>dd.global_time</code>).</p><p>Extract + plots saved to PDF (printed to screen it <code>filename</code> is omitted)</p><pre><code class="language-julia hljs">filename = joinpath(tutorial_temp_dir, &quot;$(ini.general.casename).pdf&quot;)
FUSE.extract(dd)#, filename)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">GEOMETRY                                EQUILIBRIUM                             TEMPERATURES                            </span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    
<span class="sgr34"><span class="sgr1">R0</span></span> â†’ 6.5 [m]                            <span class="sgr34"><span class="sgr1">B0</span></span> â†’ 7.8 [T]                            <span class="sgr34"><span class="sgr1">Te0</span></span> â†’ 18.1 [keV]                        
<span class="sgr34"><span class="sgr1">a</span></span> â†’ 2.01 [m]                            <span class="sgr34"><span class="sgr1">ip</span></span> â†’ 12.7 [MA]                          <span class="sgr34"><span class="sgr1">Ti0</span></span> â†’ 19.9 [keV]                        
<span class="sgr34"><span class="sgr1">1/Ïµ</span></span> â†’ 3.24                              <span class="sgr34"><span class="sgr1">q95</span></span> â†’ 6.05                              <span class="sgr34"><span class="sgr1">&lt;Te&gt;</span></span> â†’ 8.8 [keV]                        
<span class="sgr34"><span class="sgr1">Îº</span></span> â†’ 2                                   <span class="sgr34"><span class="sgr1">&lt;Bpol&gt;</span></span> â†’ 0.799 [T]                      <span class="sgr34"><span class="sgr1">&lt;Ti&gt;</span></span> â†’ 7.98 [keV]                       
<span class="sgr34"><span class="sgr1">Î´</span></span> â†’ 0.588                               <span class="sgr34"><span class="sgr1">Î²pol_MHD</span></span> â†’ 0.846                        <span class="sgr34"><span class="sgr1">Te0/&lt;Te&gt;</span></span> â†’ 2.05                         
<span class="sgr34"><span class="sgr1">Î¶</span></span> â†’ -0.0136                             <span class="sgr34"><span class="sgr1">Î²tor_MHD</span></span> â†’ 0.00916                      <span class="sgr34"><span class="sgr1">Ti0/&lt;Ti&gt;</span></span> â†’ 2.5                          
<span class="sgr34"><span class="sgr1">Volume</span></span> â†’ 929 [mÂ³]                       <span class="sgr34"><span class="sgr1">Î²n_MHD</span></span> â†’ 1.12                                                                   
<span class="sgr34"><span class="sgr1">Surface</span></span> â†’ 758 [mÂ²]                                                                                                      
                                                                                                                        
<span class="sgr1">DENSITIES                               PRESSURES                               TRANSPORT                               </span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    
<span class="sgr34"><span class="sgr1">ne0</span></span> â†’ 9.77e+19 [mâ»Â³]                    <span class="sgr34"><span class="sgr1">P0</span></span> â†’ 0.662 [MPa]                        <span class="sgr34"><span class="sgr1">Ï„e</span></span> â†’ 2.38 [s]                           
<span class="sgr34"><span class="sgr1">ne_ped</span></span> â†’ 6.88e+19 [mâ»Â³]                 <span class="sgr34"><span class="sgr1">&lt;P&gt;</span></span> â†’ 0.222 [MPa]                       <span class="sgr34"><span class="sgr1">Ï„e_exp</span></span> â†’ 1.84 [s]                       
<span class="sgr34"><span class="sgr1">ne_line</span></span> â†’ 8.52e+19 [mâ»Â³]                <span class="sgr34"><span class="sgr1">P0/&lt;P&gt;</span></span> â†’ 2.97                           <span class="sgr34"><span class="sgr1">H98y2</span></span> â†’ 0.879                           
<span class="sgr34"><span class="sgr1">&lt;ne&gt;</span></span> â†’ 7.67e+19 [mâ»Â³]                   <span class="sgr34"><span class="sgr1">Î²n</span></span> â†’ 1.14                               <span class="sgr34"><span class="sgr1">H98y2_exp</span></span> â†’ 0.812                       
<span class="sgr34"><span class="sgr1">ne0/&lt;ne&gt;</span></span> â†’ 1.27                         <span class="sgr34"><span class="sgr1">Î²n_th</span></span> â†’ 1.08                            <span class="sgr34"><span class="sgr1">Hds03</span></span> â†’ 0.651                           
<span class="sgr34"><span class="sgr1">fGW</span></span> â†’ 0.852                                                                     <span class="sgr34"><span class="sgr1">Hds03_exp</span></span> â†’ 0.58                        
<span class="sgr34"><span class="sgr1">zeff_ped</span></span> â†’ 2                                                                    <span class="sgr34"><span class="sgr1">Ï„Î±_thermalization</span></span> â†’ 0.81 [s]            
<span class="sgr34"><span class="sgr1">&lt;zeff&gt;</span></span> â†’ 2                                                                      <span class="sgr34"><span class="sgr1">Ï„Î±_slowing_down</span></span> â†’ 0.881 [s]             
<span class="sgr34"><span class="sgr1">impurities</span></span> â†’ DT Ne20 He4                                                                                                
                                                                                                                        
<span class="sgr1">SOURCES                                 EXHAUST                                 CURRENTS                                </span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    
<span class="sgr34"><span class="sgr1">Pec</span></span> â†’ 50 [MW]                           <span class="sgr34"><span class="sgr1">Psol</span></span> â†’ 124 [MW]                         <span class="sgr34"><span class="sgr1">ip_bs_aux_ohm</span></span> â†’ 13 [MA]                 
<span class="sgr34"><span class="sgr1">rho0_ec</span></span> â†’ 0.56 [MW]                     <span class="sgr34"><span class="sgr1">PLH</span></span> â†’ 136 [MW]                          <span class="sgr34"><span class="sgr1">ip_ni</span></span> â†’ 6.13 [MA]                       
<span class="sgr34"><span class="sgr1">Pnbi</span></span> â†’ <span class="sgr31">NaN</span> [MW]                         <span class="sgr34"><span class="sgr1">Bpol_omp</span></span> â†’ 1.12 [T]                     <span class="sgr34"><span class="sgr1">ip_bs</span></span> â†’ 3.15 [MA]                       
<span class="sgr34"><span class="sgr1">Enbi1</span></span> â†’ <span class="sgr31">NaN</span> [MeV]                       <span class="sgr34"><span class="sgr1">Î»q</span></span> â†’ 0.968 [mm]                         <span class="sgr34"><span class="sgr1">ip_aux</span></span> â†’ 2.98 [MA]                      
<span class="sgr34"><span class="sgr1">Pic</span></span> â†’ 50 [MW]                           <span class="sgr34"><span class="sgr1">qpol</span></span> â†’ 2.39e+03 [MW/mÂ²]                 <span class="sgr34"><span class="sgr1">ip_ohm</span></span> â†’ 6.88 [MA]                      
<span class="sgr34"><span class="sgr1">Plh</span></span> â†’ <span class="sgr31">NaN</span> [MW]                          <span class="sgr34"><span class="sgr1">qpar</span></span> â†’ 1.3e+04 [MW/mÂ²]                  <span class="sgr34"><span class="sgr1">ejima</span></span> â†’ 0.4                             
<span class="sgr34"><span class="sgr1">Paux_tot</span></span> â†’ 100 [MW]                     <span class="sgr34"><span class="sgr1">P/R0</span></span> â†’ 19 [MW/m]                        <span class="sgr34"><span class="sgr1">flattop</span></span> â†’ 0.7 [Hours]                   
<span class="sgr34"><span class="sgr1">PÎ±</span></span> â†’ 59.4 [MW]                          <span class="sgr34"><span class="sgr1">PB/R0</span></span> â†’ 148 [MW T/m]                                                            
<span class="sgr34"><span class="sgr1">Pohm</span></span> â†’ 0.55 [MW]                        <span class="sgr34"><span class="sgr1">PBp/R0</span></span> â†’ 15.2 [MW T/m]                                                          
<span class="sgr34"><span class="sgr1">Pheat</span></span> â†’ 160 [MW]                        <span class="sgr34"><span class="sgr1">PBÏµ/R0q95</span></span> â†’ 7.58 [MW T/m]                                                       
<span class="sgr34"><span class="sgr1">Prad_tot</span></span> â†’ -36.3 [MW]                   <span class="sgr34"><span class="sgr1">neutrons_peak</span></span> â†’ 0.394 [MW/mÂ²]                                                   
                                                                                                                        
<span class="sgr1">BOP                                     BUILD                                   COSTING                                 </span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    
<span class="sgr34"><span class="sgr1">Pfusion</span></span> â†’ 297 [MW]                      <span class="sgr34"><span class="sgr1">PF_material</span></span> â†’ nb3sn                     <span class="sgr34"><span class="sgr1">capital_cost</span></span> â†’ 7.25 [$B]                
<span class="sgr34"><span class="sgr1">Qfusion</span></span> â†’ 2.97                          <span class="sgr34"><span class="sgr1">TF_material</span></span> â†’ nb3sn_kdemo               <span class="sgr34"><span class="sgr1">levelized_CoE</span></span> â†’ Inf [$/kWh]             
<span class="sgr34"><span class="sgr1">thermal_cycle_type</span></span> â†’ rankine            <span class="sgr34"><span class="sgr1">OH_material</span></span> â†’ nb3sn                     <span class="sgr34"><span class="sgr1">TF_of_total</span></span> â†’ 16 [%]                    
<span class="sgr34"><span class="sgr1">thermal_efficiency_plant</span></span> â†’ 22.7 [%]     <span class="sgr34"><span class="sgr1">TF_max_b</span></span> â†’ 15.4 [T]                     <span class="sgr34"><span class="sgr1">BOP_of_total</span></span> â†’ 1.72 [%]                 
<span class="sgr34"><span class="sgr1">thermal_efficiency_cycle</span></span> â†’ <span class="sgr31">NaN</span> [%]      <span class="sgr34"><span class="sgr1">OH_max_b</span></span> â†’ 16.2 [T]                     <span class="sgr34"><span class="sgr1">blanket_of_total</span></span> â†’ 17.4 [%]             
<span class="sgr34"><span class="sgr1">power_electric_generated</span></span> â†’ 19.4 [MW]    <span class="sgr34"><span class="sgr1">TF_j_margin</span></span> â†’ 6.59                      <span class="sgr34"><span class="sgr1">cryostat_of_total</span></span> â†’ 2.82 [%]            
<span class="sgr34"><span class="sgr1">Pelectric_net</span></span> â†’ -126 [MW]               <span class="sgr34"><span class="sgr1">OH_j_margin</span></span> â†’ 1.41                                                              
<span class="sgr34"><span class="sgr1">Qplant</span></span> â†’ 0.134                          <span class="sgr34"><span class="sgr1">TF_stress_margin</span></span> â†’ 3.03                                                         
<span class="sgr34"><span class="sgr1">TBR</span></span> â†’ 0.0732                            <span class="sgr34"><span class="sgr1">OH_stress_margin</span></span> â†’ 1.36                                                         
                                                                                                                        
</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">Â« Main</a><a class="docs-footer-nextpage" href="examples.html">Examples Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Wednesday 21 May 2025 19:41">Wednesday 21 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
